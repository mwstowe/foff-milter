# FOFF Milter v0.7.0 - Configuration Example
# This file shows default values with sample configurations commented out

# =============================================================================
# SYSTEM CONFIGURATION
# =============================================================================
[system]
# Unix socket path for milter communication
socket_path = "/var/run/foff-milter.sock"

# Convert REJECT actions to TAG actions (default: true)
reject_to_tag = true

# =============================================================================
# MODULAR DETECTION SYSTEM
# =============================================================================
[modules]
# Enable modular detection system
enabled = true
# Directory containing module configuration files
config_dir = "rulesets"

# =============================================================================
# FEATURE ANALYSIS SYSTEM
# =============================================================================
[features]
# Enable intelligent feature analysis
enabled = true
# Directory containing feature configuration files
config_dir = "features"

# =============================================================================
# HEURISTIC SCORING SYSTEM
# =============================================================================
[heuristics]
# Score threshold for REJECT action
reject_threshold = 350
# Score threshold for TAG AS SPAM action
spam_threshold = 60
# Score threshold for ACCEPT action (below this = accept)
accept_threshold = 0

# =============================================================================
# SENDER BLOCKING (Pattern-based blocking)
# =============================================================================
[sender_blocking]
# Enable explicit sender pattern blocking
enabled = true
# Patterns that will immediately block emails
block_patterns = [
    # Add specific patterns to block
    # ".*@suspicious-domain\\.com$",
    # ".*spammer.*@.*",
    # ".*@.*\\.tk$"
]
# Action to take: "reject" or "tag"
action = "reject"

# =============================================================================
# GLOBAL WHITELIST
# =============================================================================
[whitelist]
# Enable whitelist (highest priority - bypasses all checks)
enabled = true

# Exact email addresses to whitelist
addresses = [
    # "noreply@paypal.com",
    # "security@amazon.com",
    # "notifications@github.com"
]

# Exact domains to whitelist
domains = [
    # "paypal.com",
    # "amazon.com", 
    # "github.com",
    # "microsoft.com"
]

# Domain patterns to whitelist (regex)
domain_patterns = [
    # ".*\\.gov$",        # Government domains
    # ".*\\.edu$",        # Educational institutions
    # ".*\\.mil$"         # Military domains
]

# =============================================================================
# GLOBAL BLOCKLIST
# =============================================================================
[blocklist]
# Enable blocklist (blocks before rule evaluation)
enabled = true

# Exact email addresses to block
addresses = [
    # "spam@badactor.com",
    # "phishing@scammer.net"
]

# Exact domains to block
domains = [
    # "badactor.com",
    # "scammer.net",
    # "malware.tk"
]

# Domain patterns to block (regex)
domain_patterns = [
    # ".*\\.tk$",         # Tokelau (free domain)
    # ".*\\.ml$",         # Mali (free domain)
    # ".*\\.ga$",         # Gabon (free domain)
    # ".*\\.cf$"          # Central African Republic (free domain)
]

# =============================================================================
# LEGACY YAML SUPPORT
# =============================================================================
[legacy]
# Enable legacy YAML rule support (for migration)
enabled = false
# Path to legacy YAML configuration file
config_file = "/etc/foff-milter/legacy-rules.yaml"

# =============================================================================
# STATISTICS & ANALYTICS
# =============================================================================
[statistics]
# Enable statistics collection
enabled = true
# SQLite database path for statistics
database_path = "/var/lib/foff-milter/stats.db"
# How often to flush statistics to database (seconds)
flush_interval_seconds = 60

# =============================================================================
# DEFAULT ACTION
# =============================================================================
[default_action]
# Action to take when no rules match
type = "Accept"

# Alternative default actions:
# type = "Reject"
# message = "Message rejected by policy"
#
# type = "TagAsSpam"
# header_name = "X-Spam-Flag"
# header_value = "YES"

# =============================================================================
# DOMAIN CLASSIFICATIONS (Override YAML configs only)
# =============================================================================
# [domain_classifications]
# # Only specify these to OVERRIDE values from YAML configuration files
# # Domain classifications are loaded from config/*.yaml by default
# 
# # Override free email providers
# free_email_providers = [
#     # "custom-provider.com"
# ]
# 
# # Override email infrastructure providers  
# email_infrastructure = [
#     # "custom-infrastructure.com"
# ]
# 
# # Override high risk TLDs
# high_risk_tlds = [
#     # ".custom-tld"
# ]

# =============================================================================
# PERFORMANCE TUNING (Optional)
# =============================================================================
# [performance]
# # Maximum number of concurrent emails to process
# max_concurrent_emails = 100
# # Timeout for email processing in seconds
# timeout_seconds = 30

# =============================================================================
# LOGGING CONFIGURATION (Optional)
# =============================================================================
# [logging]
# # Log level: trace, debug, info, warn, error
# level = "info"
# # Log file path (if not specified, logs to stderr)
# # file = "/var/log/foff-milter/foff-milter.log"
