# FOFF Milter v0.7.0 - Configuration Example
# This file shows default values with sample configurations commented out

# =============================================================================
# SYSTEM CONFIGURATION
# =============================================================================
[system]
# Unix socket path for milter communication
socket_path = "/var/run/foff-milter.sock"

# Convert REJECT actions to TAG actions (default: true)
reject_to_tag = true

# =============================================================================
# MODULAR DETECTION SYSTEM
# =============================================================================
[modules]
# Enable modular detection system (default: true)
enabled = true
# Directory containing module configuration files
# Default: /etc/foff-milter/rulesets (Linux) or /usr/local/etc/foff-milter/rulesets (FreeBSD)
config_dir = "/etc/foff-milter/rulesets"

# =============================================================================
# FEATURE ANALYSIS SYSTEM
# =============================================================================
[features]
# Enable intelligent feature analysis (default: true)
enabled = true
# Directory containing feature configuration files  
# Default: /etc/foff-milter/features (Linux) or /usr/local/etc/foff-milter/features (FreeBSD)
config_dir = "/etc/foff-milter/features"

# =============================================================================
# HEURISTIC SCORING SYSTEM
# =============================================================================
[heuristics]
# Score threshold for REJECT action (default: 350)
reject_threshold = 350
# Score threshold for TAG AS SPAM action (default: 50)
spam_threshold = 50
# Score threshold for ACCEPT action (default: 0)
accept_threshold = 0

# =============================================================================
# SENDER BLOCKING (Pattern-based blocking)
# =============================================================================
[sender_blocking]
# Enable explicit sender pattern blocking (default: true)
enabled = true
# Patterns that will immediately block emails (default: empty)
block_patterns = [
    # ".*@suspicious-domain\\.com$",
    # ".*spammer.*@.*",
    # ".*@.*\\.tk$"
]
# Action to take: "reject" or "tag" (default: "reject")
action = "reject"

# =============================================================================
# GLOBAL WHITELIST
# =============================================================================
[whitelist]
# Enable whitelist - bypasses all checks (default: true)
enabled = true

# Exact email addresses to whitelist (default: empty)
addresses = [
    # "noreply@paypal.com",
    # "security@amazon.com",
    # "notifications@github.com"
]

# Exact domains to whitelist (default: empty)
domains = [
    # "paypal.com",
    # "amazon.com", 
    # "github.com",
    # "microsoft.com"
]

# Domain patterns to whitelist - regex (default: empty)
domain_patterns = [
    # ".*\\.gov$",        # Government domains
    # ".*\\.edu$",        # Educational institutions
    # ".*\\.mil$"         # Military domains
]

# =============================================================================
# GLOBAL BLOCKLIST
# =============================================================================
[blocklist]
# Enable blocklist - blocks before rule evaluation (default: true)
enabled = true

# Exact email addresses to block (default: empty)
addresses = [
    # "spam@badactor.com",
    # "phishing@scammer.net"
]

# Exact domains to block (default: empty)
domains = [
    # "badactor.com",
    # "scammer.net",
    # "malware.tk"
]

# Domain patterns to block - regex (default: empty)
domain_patterns = [
    # ".*\\.tk$",         # Tokelau (free domain)
    # ".*\\.ml$",         # Mali (free domain)
    # ".*\\.ga$",         # Gabon (free domain)
    # ".*\\.cf$"          # Central African Republic (free domain)
]

# =============================================================================
# LEGACY YAML SUPPORT
# =============================================================================
[legacy]
# Enable legacy YAML rule support (default: false)
enabled = false
# Path to legacy YAML configuration file
config_file = "/etc/foff-milter/legacy-rules.yaml"

# =============================================================================
# STATISTICS & ANALYTICS
# =============================================================================
[statistics]
# Enable statistics collection (default: true)
enabled = true
# SQLite database path for statistics
database_path = "/var/lib/foff-milter/stats.db"
# How often to flush statistics to database in seconds (default: 60)
flush_interval_seconds = 60

# =============================================================================
# DEFAULT ACTION
# =============================================================================
[default_action]
# Action to take when no rules match (default: "Accept")
type = "Accept"

# Alternative default actions:
# type = "Reject"
# message = "Message rejected by policy"
#
# type = "TagAsSpam"
# header_name = "X-Spam-Flag"
# header_value = "YES"

# =============================================================================
# DOMAIN CLASSIFICATIONS (Override YAML configs only)
# =============================================================================
# Only specify these to OVERRIDE values from YAML configuration files
# Domain classifications are loaded from config/*.yaml by default
# 
# [domain_classifications]
# Override free email providers
# free_email_providers = [
#     "custom-provider.com"
# ]
# 
# Override email infrastructure providers  
# email_infrastructure = [
#     "custom-infrastructure.com"
# ]
# 
# Override high risk TLDs
# high_risk_tlds = [
#     ".custom-tld"
# ]

# =============================================================================
# PERFORMANCE TUNING (Optional)
# =============================================================================
# [performance]
# Maximum number of concurrent emails to process (default: 100)
# max_concurrent_emails = 100
# Timeout for email processing in seconds (default: 30)
# timeout_seconds = 30

# =============================================================================
# LOGGING CONFIGURATION (Optional)
# =============================================================================
# [logging]
# Log level: trace, debug, info, warn, error (default: "info")
# level = "info"
# Log file path (if not specified, logs to stderr)
# file = "/var/log/foff-milter/foff-milter.log"
