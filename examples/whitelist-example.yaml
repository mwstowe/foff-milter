# Example whitelist configuration
# This shows how to separate environment-specific whitelists from main rules

socket_path: "/var/run/foff-milter.sock"
default_action:
  type: "Accept"

rules:
  # Environment-specific whitelist rules
  # These should be customized for each deployment environment

  # Trusted Gmail senders (replace with your trusted contacts)
  - name: "Whitelist trusted Gmail sender john.doe"
    criteria:
      type: "SenderPattern"
      pattern: "john\\.doe@gmail\\.com"
    action:
      type: "Accept"

  - name: "Whitelist trusted Gmail sender jane.smith"
    criteria:
      type: "SenderPattern"
      pattern: "jane\\.smith@gmail\\.com"
    action:
      type: "Accept"

  # Trusted business domains (replace with your business partners)
  - name: "Whitelist trusted business partner"
    criteria:
      type: "SenderPattern"
      pattern: ".*@trusted-partner\\.com$"
    action:
      type: "Accept"

  - name: "Whitelist important vendor"
    criteria:
      type: "SenderPattern"
      pattern: ".*@important-vendor\\.com$"
    action:
      type: "Accept"

  # Organization-specific blocking rules (customize for your domain)
  - name: "Block SparkPost to internal queue"
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: ".*\\.sparkpostmail\\.com"
        - type: "RecipientPattern"
          pattern: "queue@yourcompany\\.com"  # Replace with your domain
    action:
      type: "Reject"
      message: "SparkPost blocked for internal queue"

  # Internal system whitelists (customize for your infrastructure)
  - name: "Whitelist internal monitoring system"
    criteria:
      type: "SenderPattern"
      pattern: "monitoring@yourcompany\\.com"  # Replace with your domain
    action:
      type: "Accept"

  - name: "Whitelist backup system notifications"
    criteria:
      type: "SenderPattern"
      pattern: "backup@yourcompany\\.com"  # Replace with your domain
    action:
      type: "Accept"

  # Google Groups whitelist (generic - usually safe to keep as-is)
  - name: "Whitelist Google Groups mailing lists"
    criteria:
      type: "Or"
      criteria:
        - type: "HeaderPattern"
          header: "list-id"
          pattern: ".*\\.googlegroups\\.com"
        - type: "HeaderPattern"
          header: "x-google-group-id"
          pattern: "\\d+"
    action:
      type: "Accept"

# Note: After customizing this file, merge it with your base rules
# Example merge command:
# yq eval-all 'select(fileIndex == 0) * select(fileIndex == 1)' \
#   rules-base.yaml whitelist-production.yaml > final-config.yaml
