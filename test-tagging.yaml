socket_path: "/var/run/foff-milter.sock"
default_action:
  type: "Accept"

rules:
  - name: "Tag Russian domains"
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*\\.ru\\.com$"
    action:
      type: "TagAsSpam"
      header_name: "X-Spam-Flag"
      header_value: "YES"

  - name: "Tag all .ru domains"
    criteria:
      type: "SenderPattern" 
      pattern: ".*@.*\\.ru$"
    action:
      type: "TagAsSpam"
      header_name: "X-Spam-Russian"
      header_value: "Russian domain detected"

  - name: "Block suspicious Chinese services"
    criteria:
      type: "MailerPattern"
      pattern: "service\\..*\\.cn"
    action:
      type: "Reject"
      message: "Mail from suspicious service rejected"

  - name: "Block Chinese services with Japanese content"
    criteria:
      type: "And"
      criteria:
        - type: "MailerPattern"
          pattern: "service\\..*\\.cn"
        - type: "SubjectContainsLanguage"
          language: "japanese"
    action:
      type: "Reject"
      message: "Spam rejected"
