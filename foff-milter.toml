# FOFF Milter Main Configuration
# Production configuration in TOML format

[system]
socket_path = "/var/run/foff-milter.sock"
# Convert REJECT actions to TAG actions (default: true)
# When enabled, emails that would be rejected are tagged instead
reject_to_tag = true

[rulesets]
enabled = true
config_dir = "rulesets"

[features]
enabled = true
config_dir = "features"

[heuristics]
# Score thresholds for actions
reject_threshold = 350  # High threshold - most emails tagged rather than rejected
spam_threshold = 60     # Tag as spam at this score
accept_threshold = 0    # Accept below spam threshold

[sender_blocking]
# Explicit sender pattern blocking
enabled = true
# Patterns that will immediately reject emails (score: 1000)
block_patterns = [
    # Example patterns - add specific senders to block
    # ".*@suspicious-domain\\.com$",
    # ".*spammer.*@.*",
    # ".*@.*\\.tk$"
]
# Action to take: "reject" or "tag"
action = "reject"

[whitelist]
enabled = true
# Exact email addresses to whitelist
addresses = [
    "noreply@paypal.com",
    "security@amazon.com",
    "notifications@github.com"
]
# Domains to whitelist (exact match)
domains = [
    "paypal.com",
    "amazon.com", 
    "github.com",
    "microsoft.com"
]
# Domain patterns to whitelist (regex)
domain_patterns = [
    ".*\\.gov$",
    ".*\\.edu$",
    ".*\\.mil$"
]

[blocklist]
enabled = true
# Exact email addresses to block
addresses = [
    "spam@badactor.com",
    "phishing@scammer.net"
]
# Domains to block (exact match)
domains = [
    "badactor.com",
    "scammer.net",
    "malware.tk"
]
# Domain patterns to block (regex)
domain_patterns = [
    ".*\\.tk$",
    ".*\\.ml$",
    ".*\\.ga$",
    ".*\\.cf$"
]

[legacy]
enabled = false
config_file = "/etc/foff-milter/legacy-rules.yaml"

[statistics]
enabled = true
database_path = "/var/lib/foff-milter/stats.db"
flush_interval_seconds = 60

[default_action]
type = "Accept"

[domain_classifications]
free_email_providers = [
    "gmail.com",
    "outlook.com", 
    "yahoo.com",
    "hotmail.com",
    "aol.com",
    "protonmail.com",
    "icloud.com"
]

email_infrastructure = [
    "mailchimp.com",
    "constantcontact.com", 
    "sendgrid.net",
    "mailgun.org",
    "amazonses.com",
    "sparkpostmail.com",
    "ifttt.com",
    "filtersfast.com"
]

high_risk_tlds = [
    ".tk",
    ".ml", 
    ".ga",
    ".cf",
    ".ru.com"
]
