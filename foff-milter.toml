# FOFF Milter Main Configuration
# Production configuration in TOML format

[system]
socket_path = "/var/run/foff-milter.sock"
# Convert REJECT actions to TAG actions (default: true)
# When enabled, emails that would be rejected are tagged instead
reject_to_tag = true

[modules]
enabled = true
config_dir = "modules"

[heuristics]
# Score thresholds for actions
reject_threshold = 350
spam_threshold = 50
accept_threshold = 0

[whitelist]
enabled = true
# Exact email addresses to whitelist
addresses = [
    "noreply@paypal.com",
    "security@amazon.com",
    "notifications@github.com"
]
# Domains to whitelist (exact match)
domains = [
    "paypal.com",
    "amazon.com", 
    "github.com",
    "microsoft.com"
]
# Domain patterns to whitelist (regex)
domain_patterns = [
    ".*\\.gov$",
    ".*\\.edu$",
    ".*\\.mil$"
]

[blocklist]
enabled = true
# Exact email addresses to block
addresses = [
    "spam@badactor.com",
    "phishing@scammer.net"
]
# Domains to block (exact match)
domains = [
    "badactor.com",
    "scammer.net",
    "malware.tk"
]
# Domain patterns to block (regex)
domain_patterns = [
    ".*\\.tk$",
    ".*\\.ml$",
    ".*\\.ga$",
    ".*\\.cf$"
]

[legacy]
enabled = false
config_file = "/etc/foff-milter/legacy-rules.yaml"

[statistics]
enabled = true
database_path = "/var/lib/foff-milter/stats.db"
flush_interval_seconds = 60

[default_action]
type = "Accept"
