name: "Analytics"
enabled: true
rules:
  - name: "High Volume Sender Detection"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@.*(bulk|mass|newsletter|marketing|promo|campaign|blast|mailer)\\."
        - type: "Not"
          criteria:
            type: "And"
            criteria:
              - type: "HeaderPattern"
                header: "Authentication-Results"
                pattern: "dkim=pass"
              - type: "HeaderPattern"
                header: "List-Unsubscribe"
                pattern: ".*"
        - type: "Not"
          criteria:
            type: "BodyPattern"
            pattern: "(?i).*(unsubscribe|privacy.*policy|newsletter|promotional.*content).*"
    score: 15
    description: "Detects high-volume email senders with suspicious patterns"

  - name: "Suspicious Timing Patterns"
    enabled: true
    criteria:
      type: "HeaderPattern"
      header: "Date"
      pattern: ".*(0[0-4]:[0-5][0-9]:[0-5][0-9]|2[3-4]:[0-5][0-9]:[0-5][0-9]).*"
    score: 10
    description: "Emails sent during suspicious hours (midnight to 5am, 11pm-midnight)"

  - name: "Sequential Email Pattern"
    enabled: true
    criteria:
      type: "RecipientPattern"
      pattern: ".*[0-9]{3,}@.*"
    score: 20
    description: "Recipients with sequential numbers indicating enumeration attacks"

  - name: "Burst Pattern Indicators"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "HeaderPattern"
          header: "Message-ID"
          pattern: ".*[0-9]{10,}.*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*(empower\\.com|iheart\\.com|wayfair\\.com|backerkit\\.com|spotify\\.com|pandora\\.com|netflix\\.com).*"
    score: 5
    description: "Message IDs with long numeric sequences indicating automated sending (excludes legitimate media/entertainment)"

  - name: "Generic Sender Names"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: ".*(no-reply|noreply|donotreply|admin|support|info|contact|service|team|notification|alert|system)@.*"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "HeaderPattern"
                header: "From"
                pattern: ".*@(asus\\.com|.*\\.asus\\.com|microsoft\\.com|.*\\.microsoft\\.com|google\\.com|.*\\.google\\.com|amazon\\.com|.*\\.amazon\\.com|apple\\.com|.*\\.apple\\.com|shopify\\.com|.*\\.shopify\\.com|lovepopcards\\.com|pixlr\\.com|.*\\.pixlr\\.com|.*netsuite\\.com|.*oracleemaildelivery\\.com|bcdtravel\\.com|.*\\.bcdtravel\\.com|concur\\.com|.*\\.concur\\.com|expensify\\.com|.*\\.expensify\\.com|doordash\\.com|.*\\.doordash\\.com|backstage\\.com|.*\\.backstage\\.com|send\\.backstage\\.com|kiwico\\.com|.*\\.kiwico\\.com|namemaker\\.com|.*\\.namemaker\\.com|levi\\.com|.*\\.levi\\.com|gap\\.com|.*\\.gap\\.com|nike\\.com|.*\\.nike\\.com|adidas\\.com|.*\\.adidas\\.com|macys\\.com|.*\\.macys\\.com|nordstrom\\.com|.*\\.nordstrom\\.com|target\\.com|.*\\.target\\.com|walmart\\.com|.*\\.walmart\\.com).*"
              - type: "HeaderPattern"
                header: "X-NetSuite"
                pattern: ".*"
              - type: "And"
                criteria:
                  - type: "HeaderPattern"
                    header: "Authentication-Results"
                    pattern: "dkim=pass"
                  - type: "HeaderPattern"
                    header: "List-Unsubscribe"
                    pattern: ".*"
    score: 2
    description: "Generic sender addresses often used in bulk spam campaigns, excluding business systems"

  # Random character sender detection
  - name: "Random character senders"
    criteria:
      type: "SenderPattern"
      pattern: ".*@[a-z0-9]{3,8}@.*|.*[0-9]{3,}[a-z]{1,3}@.*"
    score: 50
    description: "Senders with random character patterns (e.g., 2qo9o@, maju1@)"

  - name: "NetSuite Business System Recognition"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "HeaderPattern"
          header: "x-netsuite"
          pattern: ".*"
        - type: "SenderPattern"
          pattern: ".*@.*(netsuite\\.com|oracleemaildelivery\\.com|sent-via\\.netsuite\\.com)$"
        - type: "HeaderPattern"
          header: "from"
          pattern: ".*@.*netsuite\\.com.*"
    score: -50
    description: "Legitimate NetSuite business system emails"

  - name: "Sender Name Mismatch"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "FreeEmailProvider"
          check_sender: true
        - type: "HeaderPattern"
          header: "from"
          pattern: "(?i)^[A-Z]{3,15}\\s*<.*@.*>$"
    score: 20
    description: "Detects generic all-caps sender names from free email providers"

  - name: "Suspicious Domain Age Indicators"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@[a-z0-9]{6,12}\\.(tk|ml|ga|cf|gq|top|click|download|stream|xyz|info|biz)$"
    score: 25
    description: "Random domain names on suspicious TLDs indicating newly registered domains"
