name: "Advanced Heuristics"
enabled: true
rules:
  - name: "Bayesian Spam Word Patterns"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(free|win|winner|congratulations|urgent|act.*now|limited.*time|exclusive|special.*offer|guaranteed|amazing|incredible|revolutionary).*"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "SenderPattern"
                pattern: ".*@(dominos\\.com|e-offers\\.dominos\\.com|.*\\.dominos\\.com)$"
              - type: "SenderPattern"
                pattern: ".*@(amazon\\.com|.*\\.amazon\\.com|amazonses\\.com)$"
              - type: "SenderPattern"
                pattern: ".*@(paypal\\.com|.*\\.paypal\\.com)$"
              - type: "SenderPattern"
                pattern: ".*@(wolfermans\\.com|.*wolfermans.*\\.com|.*filtersfast\\.com|.*\\.filtersfast\\.com|.*backerkit\\.com|.*\\.backerkit\\.com)$"
              - type: "SenderPattern"
                pattern: ".*@(.*nextdoor\\.com|suncadia\\.com)$"
              - type: "HeaderPattern"
                header: "List-Unsubscribe"
                pattern: ".*"
    score: 10
    description: "High-probability spam words based on Bayesian analysis"

  - name: "Sender Reputation Scoring"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@[a-z0-9]{8,15}\\.(tk|ml|ga|cf|gq)$"
        - type: "SenderPattern"
          pattern: ".*@[a-z0-9]{8,15}\\.(top|click|download|stream)$"
    score: 35
    description: "Low reputation domains with random names on suspicious TLDs"

  - name: "Content Similarity Detection"
    enabled: true
    criteria:
      type: "SubjectPattern"
      pattern: "(?i).*(re:.*re:|fwd:.*fwd:|fw:.*fw:).*"
    score: 15
    description: "Multiple reply/forward prefixes indicating content manipulation"

  - name: "Behavioral Pattern Scoring"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(money|cash|profit|income|earn|make.*\\$|\\$[0-9,]+).*"
        - type: "SenderPattern"
          pattern: ".*@.*(free|temp|disposable|10minute|guerrilla|mailinator).*"
    score: 45
    description: "Money-related content from temporary email services"

  - name: "Language Inconsistency Detection"
    enabled: true
    criteria:
      type: "SubjectPattern"
      pattern: "(?i).*[a-z]+.*[\\u4E00-\\u9FFF\\u3040-\\u309F\\u30A0-\\u30FF\\u0400-\\u04FF\\u0600-\\u06FF]+.*[a-z]+.*"
    score: 25
    description: "Suspicious mixing of Latin and non-Latin scripts"

  - name: "Urgency Pattern Recognition"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(urgent|asap|immediate|emergency|critical|important|action.*required|respond.*now|expires.*today).*"
            - type: "HeaderPattern"
              header: "Priority"
              pattern: "(?i)urgent"
            - type: "HeaderPattern"
              header: "X-Priority"
              pattern: "^1"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "SenderPattern"
                pattern: ".*@.*(ecoflow|generac|goal.*zero|jackery|bluetti|emergency|preparedness|safety)\\.(com|net|org)$"
              - type: "HeaderPattern"
                header: "From"
                pattern: "(?i).*(EcoFlow|Emergency|Preparedness|Safety|Generator|Power.*Station).*"
    score: 30
    description: "Artificial urgency patterns in subject or priority headers (excluding legitimate emergency/safety companies)"

  - name: "Weak Signal Aggregation"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*[!]{3,}.*"
            - type: "SubjectPattern"
              pattern: "(?i).*[A-Z]{10,}.*"
            - type: "SubjectPattern"
              pattern: "(?i).*\\$[0-9,]+.*\\$[0-9,]+.*"
            - type: "HeaderPattern"
              header: "From"
              pattern: ".*[0-9]{4,}.*"
        - type: "Not"
          criteria:
            type: "And"
            criteria:
              - type: "HeaderPattern"
                header: "Authentication-Results"
                pattern: "dkim=pass"
              - type: "Or"
                criteria:
                  - type: "HeaderPattern"
                    header: "List-Unsubscribe"
                    pattern: ".*"
                  - type: "BodyPattern"
                    pattern: "(?i).*(newsletter|unsubscribe|promotional.*content|marketing.*email).*"
                  - type: "SenderPattern"
                    pattern: ".*@(empower\\.com|.*\\.empower\\.com)$"
    score: 10
    description: "Multiple exclamation marks, excessive caps, multiple dollar amounts, or numeric sender names"

  - name: "Advanced Heuristic Scoring"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(click|visit|download|install|update|verify|confirm|activate).*"
        - type: "Not"
          criteria:
            type: "HeaderPattern"
            header: "List-Unsubscribe"
            pattern: ".*"
        - type: "Not"
          criteria:
            type: "And"
            criteria:
              - type: "SenderPattern"
                pattern: ".*@docusign\\.net$"
              - type: "HeaderPattern"
                header: "Authentication-Results"
                pattern: "dkim=pass.*docusign\\.net"
    score: 25
    description: "Action-oriented content without proper unsubscribe headers (excludes legitimate DocuSign)"
