name: "Rule-Based Whitelists"
enabled: true  # RE-ENABLED - ESP whitelist needs refinement
rules:
  # Veterinary and Pet Services
  - name: "Veterinary and Pet Services"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "HeaderPattern"
          header: "From"
          pattern: ".*@.*\\.vetcove\\.com.*"
        - type: "HeaderPattern"
          header: "DKIM-Signature"
          pattern: ".*d=.*\\.vetcove\\.com.*"
        - type: "BodyPattern"
          pattern: "(?i).*(veterinary|pet.*hospital|animal.*clinic|veterinarian)"
        - type: "SubjectPattern"
          pattern: "(?i).*(appointment.*reminder|vaccination.*due|pet.*health)"
    score: -200
    description: "Whitelist legitimate veterinary and pet service communications"

  # Retail and Commerce
  - name: "Disney Services"
    enabled: false
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*(disney|disneystore|d23)\\.com.*"
    score: -200
    description: "Disney retail and entertainment services"

  - name: "Duluth Trading Company"
    enabled: false
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*duluthtrading\\.com.*"
    score: -200
    description: "Duluth Trading Company legitimate retailer"

  - name: "Levi's"
    enabled: false
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*levi\\.com.*"
    score: -200
    description: "Levi's brand legitimate emails"

  - name: "Michaels"
    enabled: false
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*michaels.*\\.com.*"
    score: -200
    description: "Michaels craft store chain"

  - name: "1-800-FLOWERS"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*celebrations\\.com.*"
    score: -200
    description: "1-800-FLOWERS legitimate retailer"

  - name: "Wolfermans"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*wolfermans.*"
    score: -300
    description: "Wolfermans gourmet bakery legitimate retailer"

  - name: "Disney"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@.*disney.*"
        - type: "SenderPattern"
          pattern: ".*@.*d23.*"
        - type: "HeaderPattern"
          header: "DKIM-Signature"
          pattern: ".*d=.*disney.*"
    score: -400
    description: "Disney legitimate entertainment company"

  - name: "UPS"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*ups.*"
    score: -150
    description: "UPS legitimate shipping company"

  - name: "Williams Sonoma"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*williams.*sonoma.*"
    score: -150
    description: "Williams Sonoma legitimate retailer"

  - name: "King Arthur Baking"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*kingarthur.*"
    score: -150
    description: "King Arthur Baking legitimate company"

  - name: "Dominos"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*dominos.*"
    score: -150
    description: "Dominos Pizza legitimate restaurant chain"

  - name: "IKEA"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*ikea.*"
    score: -150
    description: "IKEA legitimate furniture retailer"

  - name: "Nextdoor"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@.*sendgrid.*"
        - type: "HeaderPattern"
          header: "From"
          pattern: ".*neighbors.*"
    score: -100
    description: "Nextdoor neighborhood platform via SendGrid"

  - name: "Seattle Mini"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*driveseattlemini.*"
    score: -100
    description: "Seattle Mini car dealership"

  - name: "Filters Fast"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*filtersfast\\.com.*"
    score: -200
    description: "Filters Fast air filter retailer"

  - name: "Monoprice"
    enabled: false
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*monoprice\\.com.*"
    score: -200
    description: "Monoprice electronics retailer"

  - name: "King Arthur Baking"
    enabled: false
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*kingarthurbaking\\.com.*"
    score: -200
    description: "King Arthur Baking legitimate company"

  - name: "EyeBuyDirect"
    enabled: false
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*eyebuydirect\\.com.*"
    score: -200
    description: "EyeBuyDirect eyewear retailer"

  - name: "Walgreens"
    enabled: false
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*walgreens\\.com.*"
    score: -200
    description: "Walgreens pharmacy chain"

  # Airlines and Travel
  - name: "British Airways"
    enabled: false
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*ba\\.com.*"
    score: -300
    description: "British Airways legitimate airline"

  # Technology and Electronics
  - name: "ASUS"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*asus\\.com.*"
    score: -200
    description: "ASUS computer manufacturer"

  # Medical and Healthcare
  - name: "AceMed Medical Services"
    enabled: false
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*charmtracker\\.com.*"
    score: -200
    description: "AceMed medical appointment confirmations"

  - name: "ResMed"
    enabled: false
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*resmed\\.com.*"
    score: -200
    description: "ResMed medical device company"

  # Automotive
  - name: "Seattle MINI"
    enabled: false
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*driveseattlemini\\.com.*"
    score: -200
    description: "Seattle MINI car dealership"

  # Financial and Investment Services
  - name: "Oxford Club"
    enabled: false
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*oxfordclub\\.com.*"
    score: -200
    description: "Oxford Club investment newsletters"

  # Logistics and Tracking Services
  - name: "Narvar Tracking Services"
    enabled: false
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*narvar\\.com.*"
    score: -200
    description: "Narvar order tracking service"

  # Media and Publishing
  - name: "Poshmark Marketplace Platform"
    enabled: true
    criteria:
      type: "HeaderPattern"
      header: "From"
      pattern: ".*@poshmark\\.com.*"
    score: -100
    description: "Poshmark marketplace platform - legitimate e-commerce"

  - name: "Beloit Floral Network"
    enabled: true
    criteria:
      type: "HeaderPattern"
      header: "From"
      pattern: ".*@mail\\.eflorist\\.com.*"
    score: -100
    description: "Beloit Floral via eFlorist network - legitimate florist"

  - name: "Medium Publishing Platform"
    enabled: true
    criteria:
      type: "HeaderPattern"
      header: "From"
      pattern: ".*@medium\\.com.*"
    score: -100
    description: "Medium publishing platform - legitimate newsletter"

  - name: "Fidelity Corporate Benefits"
    enabled: true
    criteria:
      type: "HeaderPattern"
      header: "From"
      pattern: ".*@.*fidelity\\.com.*"
    score: -20
    description: "Fidelity corporate benefits and 401k communications"

  - name: "E-commerce Tracking Platforms"
    enabled: true
    criteria:
      type: "HeaderPattern"
      header: "From"
      pattern: ".*@.*narvar\\.com.*"
    score: -30
    description: "Legitimate e-commerce order tracking platforms"

  - name: "Health Device Platforms"
    enabled: true
    criteria:
      type: "HeaderPattern"
      header: "From"
      pattern: ".*@.*withings.*"
    score: -200
    description: "Health and fitness device platforms"

  - name: "Professional Service Providers"
    enabled: true
    criteria:
      type: "SenderDomain"
      domains: ["eflorist.com", "1800flowers.com", "ftd.com", "teleflora.com"]
    score: -100
    description: "Professional service providers (florists) - relies on context analyzer for industry detection"

  - name: "Marketplace Platforms"
    enabled: true
    criteria:
      type: "SenderDomain"
      domains: ["poshmark.com", "ebay.com", "etsy.com", "mercari.com"]
    score: -120
    description: "Legitimate marketplace platforms - relies on context analyzer for marketplace detection"

  - name: "Newsletter Platforms"
    enabled: true
    criteria:
      type: "SenderDomain"
      domains: ["medium.com", "substack.com"]
    score: -150
    description: "Legitimate newsletter platforms - relies on context analyzer for newsletter detection"

  - name: "Medium Publishing Platform"
    enabled: false
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*medium\\.com.*"
    score: -200
    description: "Medium publishing platform legitimate emails"

  # Internet Service Providers
  - name: "Xfinity/Comcast"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*xfinity\\.com.*"
    score: -200
    description: "Xfinity/Comcast ISP legitimate emails"

  # Multi-hop whitelist preservation
  - name: "Previously whitelisted emails"
    enabled: false
    criteria:
      type: "HeaderPattern"
      header: "X-FOFF-Rule-Matched"
      pattern: ".*Oxford Club.*"
    score: -200
    description: "Preserve whitelist status from previous FOFF processing"

  # Personal Communications
  - name: "Birthday Greetings"
    enabled: false
    criteria:
      type: "And"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(happy.*birthday|birthday.*wishes|birthday.*greetings).*"
        - type: "SenderPattern"
          pattern: ".*@(gmail|yahoo|hotmail|outlook|aol|icloud)\\.com.*"
    score: -150
    description: "Legitimate birthday greetings from personal email accounts"
  - name: "Amazon Services"
    enabled: false
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@(amazon|aws)\\.com$"
        - type: "Not"
          criteria:
            type: "BodyPattern"
            pattern: "(?i).*(seo.*services|website.*ranking|google.*ranking|money.*back.*guarantee|business.*slowing|act.*fast|limited.*time.*offer)"
    score: -100
    description: "Amazon and AWS legitimate services (excluding marketing spam sent via Amazon SES)"

  - name: "Walmart"
    enabled: false
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*walmart\\.com.*"
    score: -200
    description: "Walmart retail chain"

  - name: "Target"
    enabled: false
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*target\\.com.*"
    score: -200
    description: "Target retail chain"

  # Technology Companies
  - name: "Microsoft Services"
    enabled: false
    criteria:
      type: "SenderPattern"
      pattern: ".*@(microsoft|outlook|hotmail|live|msn)\\.com.*"
    score: -100
    description: "Microsoft and related services (excludes tenant domains)"

  # Netatmo IoT device alerts - From header override
  - name: "Netatmo device alerts"
    enabled: false
    criteria:
      type: "BodyPattern"
      pattern: "(?i).*netatmo.*battery.*alert.*"
    score: -300
    description: "Netatmo IoT device battery and system alerts"

  # Secretlab furniture company - From header override  
  - name: "Secretlab furniture"
    enabled: false
    criteria:
      type: "BodyPattern"
      pattern: "(?i).*secretlab.*hsa.*fsa.*"
    score: -300
    description: "Secretlab gaming furniture company"

  # Think Vacuums retail - From header override
  - name: "Think Vacuums retail"
    enabled: false
    criteria:
      type: "SubjectPattern"
      pattern: "(?i).*Fall into Clean.*"
    score: -300
    description: "Think Vacuums retail company"

  # Precise whitelist for 11 false positives after cleanup
  - name: "Precise false positive whitelist"
    enabled: false
    criteria:
      type: "Or"
      criteria:
        - type: "SubjectPattern"
          pattern: ".*Q2FyZWdpdmVycyBEZXNlcnZlIENhcmUgVG9vIOKAlCBIZXJl4oCZ.*"
        - type: "SubjectPattern"
          pattern: "(?i).*this way to Europe with up to.*Avios.*"
        - type: "SubjectPattern"
          pattern: ".*8J+aqCAzMCUgT2ZmIChhbG1vc3QpIGV2ZXJ5dGhpbmchIE9uZSBtb3JlIGRheSB0byBzYXZlIGJpZw.*"
        - type: "SubjectPattern"
          pattern: "(?i).*Your Duluth Items Just Arrived.*order.*WEB.*"
        - type: "SubjectPattern"
          pattern: "(?i)^HAPPY BIRTHDAY!.*HAPPY BIRTHDAY!$"
        - type: "SubjectPattern"
          pattern: "(?i).*The November Issue of The Oxford Income Letter.*"
        - type: "SubjectPattern"
          pattern: "(?i).*Portfolio Update.*Life.*Next Extraordinary Chapter.*"
        - type: "SubjectPattern"
          pattern: ".*Happy=20Birthday=20from=20Seattle=20MINI.*"
        - type: "SubjectPattern"
          pattern: "(?i)^Fall into Clean.*10.*Off.*Free Shipping$"
        - type: "SubjectPattern"
          pattern: "(?i)^Thank you for shopping at Walgreens.*$"
        - type: "SubjectPattern"
          pattern: "(?i)^Thanks for your payment$"
        - type: "SubjectPattern"
          pattern: ".*QW1hem9uIDQwMShrKSBQbGFuIEludmVzdG1lbnQgT3B0aW9uIENo.*"
        - type: "SubjectPattern"
          pattern: ".*8J+NlSAyIG1lZGl1bSBwaXp6YXMuIDIgdG9wcGluZ3MgZWFjaC4g.*"
        - type: "SubjectPattern"
          pattern: ".*=F0=9F=A5=BC_Proactive_care_for_your_kidney_health.*"
        - type: "SubjectPattern"
          pattern: ".*NCBGUkVFIGdpZnRzIGFyZSB3YWl0aW5nIGZvciB5b3UuLi5jdXN0.*"
    score: -300
    description: "Precise whitelist for 11 false positives identified after cleanup"

  # Additional business senders whitelist
  - name: "Additional business senders"
    enabled: false
    criteria:
      type: "Or"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@(amazon|smile\\.amazon)\\.com$"
        - type: "SenderPattern"
          pattern: ".*@.*dominos.*"
        - type: "SenderPattern"
          pattern: ".*@.*shutterfly.*"
        - type: "SenderPattern"
          pattern: ".*@.*kidney.*health.*"
        - type: "SenderPattern"
          pattern: ".*@.*1800flowers.*"
        - type: "SenderPattern"
          pattern: ".*@.*celebrations\\.com.*"
    score: -300
    description: "Additional business senders causing false positives (excluding Amazon SES infrastructure)"

  # Google Services
  - name: "Google Services"
    enabled: false
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@(google|gmail|googlemail|youtube)\\.com$"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              # Exclude forwarded onmicrosoft emails
              - type: "And"
                criteria:
                  - type: "HeaderPattern"
                    header: "From"
                    pattern: ".*@.*\\.onmicrosoft\\.com"
                  - type: "HeaderPattern"
                    header: "Received"
                    pattern: ".*gmail\\.com.*"
              # Exclude forwarded brand impersonation
              - type: "And"
                criteria:
                  - type: "BodyPattern"
                    pattern: "(?i).*(aaa|triple.?a|car.?emergency.?kit|medicare.?kit|cvs.?processing)"
                  - type: "HeaderPattern"
                    header: "Received"
                    pattern: ".*gmail\\.com.*"
    score: -300
    description: "Google services (excludes forwarded suspicious emails)"

  - name: "Apple Services"
    enabled: false
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*(apple|icloud|me)\\.com.*"
    score: -300
    description: "Apple and related services"

  # Social Media Platforms
  - name: "Facebook"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*(facebook|facebookmail|instagram)\\.com.*"
    score: -200
    description: "Facebook and Instagram legitimate notifications"

  - name: "Twitter/X"
    enabled: false
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*(twitter|x)\\.com.*"
    score: -200
    description: "Twitter/X social media platform"

  # Financial Services
  - name: "PayPal"
    enabled: false
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*paypal\\.com.*"
    score: -300
    description: "PayPal payment services"

  - name: "Major Banks"
    enabled: false
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*(bankofamerica|chase|wellsfargo|citibank|usbank|pnc|capitalone|ally|discover|americanexpress)\\.com.*"
    score: -300
    description: "Major US banks and financial institutions"

  # Legitimate services causing false positives
  - name: "BackerKit Platform"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*backerkit\\.com$"
    score: -100
    description: "BackerKit crowdfunding platform"

  - name: "British Airways"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: "(?i).*@.*britishairways\\.com$"
    score: -100
    description: "British Airways airline communications"

  - name: "Discover Card"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: "(?i).*@.*discover\\.com$"
    score: -100
    description: "Discover financial services"

  - name: "EyeBuyDirect"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: "(?i).*@.*eyebuydirect.*"
    score: -300
    description: "EyeBuyDirect eyewear retailer"

  - name: "Facebook Notifications"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: "(?i).*@.*facebook\\.com$"
    score: -100
    description: "Facebook social media notifications"

  - name: "Filters Fast"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: "(?i).*@.*filtersfast\\.com$"
    score: -100
    description: "Filters Fast retail communications"

  - name: "Oxford Club"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: "(?i).*@.*oxfordclub\\.com$"
    score: -100
    description: "Oxford Club investment newsletter"

  - name: "ResMed"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: "(?i).*@.*resmed\\.com$"
    score: -100
    description: "ResMed medical device company"

  - name: "Think Vacuums"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: "(?i).*@.*thinkvacuums\\.com$"
    score: -100
    description: "Think Vacuums retail communications"

  - name: "Xfinity/Comcast"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: "(?i).*@.*(xfinity|comcast)\\.com$"
    score: -100
    description: "Xfinity/Comcast service communications"

  # Additional legitimate services
  - name: "Delta Air Lines"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*delta\\.com$"
    score: -300  # Increased from -200
    description: "Delta Air Lines airline"

  - name: "Costco Wholesale"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SenderPattern"
              pattern: ".*@.*costco\\.com.*"
            - type: "SenderPattern"
              pattern: ".*@.*digital\\.costco\\.com.*"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "HeaderPattern"
                header: "From"
                pattern: "(?i).*(giveaway|free.*gift|prize|winner|congratulations).*"
              - type: "SubjectPattern"
                pattern: "(?i).*(giveaway|free.*gift|prize|winner|congratulations).*"
    score: -300
    description: "Costco wholesale retailer (excluding giveaway scams)"

  - name: "BIQU/BIGTREETECH"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@.*biqu\\.equipment$"
        - type: "SenderPattern"
          pattern: ".*@.*bigtreetech\\.com$"
    score: -200
    description: "3D printing equipment manufacturer"

  - name: "Tokyo Tiger"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*tokyo-tiger\\.com$"
    score: -200
    description: "Legitimate retailer"

  - name: "Botanical Gardens and Plant Organizations"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@.*garden.*\\.(org|com)$"
        - type: "SenderPattern"
          pattern: ".*@.*botanical.*\\.(org|com)$"
        - type: "HeaderPattern"
          header: "From"
          pattern: "(?i).*(botanical|garden|nursery|arboretum).*"
    score: -150
    description: "Botanical gardens and plant organizations"

  - name: "Capital One Financial Services"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@.*capitalone.*\\.(com|net)$"
        - type: "SenderPattern"
          pattern: ".*@.*accounts\\.capitaloneshopping\\.com$"
        - type: "HeaderPattern"
          header: "From"
          pattern: "(?i).*Capital One.*"
    score: -200
    description: "Capital One financial services and shopping platform"

  - name: "Established Retail and Service Businesses"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@.*kiwico\\.com$"
        - type: "SenderPattern"
          pattern: ".*@.*suncadia\\.com$"
        - type: "SenderPattern"
          pattern: ".*@.*ctagifts\\.com$"
        - type: "HeaderPattern"
          header: "From"
          pattern: "(?i).*(KiwiCo|Suncadia|CTAGifts).*"
    score: -200
    description: "Established retail and service businesses"

  - name: "Major Restaurant Chains"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@.*arbys\\.com$"
        - type: "SenderPattern"
          pattern: ".*@.*emails\\.arbys\\.com$"
        - type: "HeaderPattern"
          header: "From"
          pattern: "(?i).*(Arby's|Arbys).*"
    score: -200
    description: "Major restaurant chains"

  - name: "Home Appliance and Kitchen Brands"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@.*kitchenaid\\.com$"
        - type: "SenderPattern"
          pattern: ".*@.*whirlpool\\.com$"
        - type: "SenderPattern"
          pattern: ".*@.*dm\\.kitchenaid\\.com$"
        - type: "HeaderPattern"
          header: "From"
          pattern: "(?i).*(KitchenAid|Whirlpool).*"
    score: -200
    description: "Home appliance and kitchen brands"

  - name: "Publishing and Media Companies"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@.*condenast\\.com$"
        - type: "SenderPattern"
          pattern: ".*@.*eml\\.condenast\\.com$"
        - type: "SenderPattern"
          pattern: ".*@.*nationalgeographic\\.com$"
        - type: "SenderPattern"
          pattern: ".*@.*email\\.nationalgeographic\\.com$"
        - type: "HeaderPattern"
          header: "From"
          pattern: "(?i).*(Vogue|National Geographic|Nat Geo).*"
    score: -200
    description: "Publishing and media companies"

  - name: "Emergency Preparedness and Safety Companies"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@.*ecoflow\\.com$"
        - type: "SenderPattern"
          pattern: ".*@.*info\\.ecoflow\\.com$"
        - type: "HeaderPattern"
          header: "From"
          pattern: "(?i).*EcoFlow.*"
    score: -150
    description: "Emergency preparedness and safety companies"

  - name: "Established Tableware and Home Goods"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@.*fiestatableware\\.com$"
        - type: "HeaderPattern"
          header: "From"
          pattern: "(?i).*Fiesta Dinnerware.*"
    score: -150
    description: "Established tableware and home goods companies"

  - name: "Independent Publishers and Non-Profit Organizations"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@.*pmpress\\.org$"
        - type: "HeaderPattern"
          header: "From"
          pattern: "(?i).*(PM Press|Independent Publisher).*"
        - type: "And"
          criteria:
            - type: "SenderPattern"
              pattern: ".*@gmail\\.com$"
            - type: "HeaderPattern"
              header: "From"
              pattern: ".*@.*\\.org>$"
    score: -200
    description: "Independent publishers and non-profit organizations"

  - name: "Payment Processors and Business Services"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@.*quickbooks.*\\.(com|net)$"
        - type: "SenderPattern"
          pattern: ".*@.*intuit\\.(com|net)$"
        - type: "HeaderPattern"
          header: "From"
          pattern: "(?i).*(QuickBooks|Intuit|Payment).*"
    score: -200
    description: "Payment processors and business services"

  - name: "Medical and Healthcare Services"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@.*charmtracker\\.com$"
        - type: "HeaderPattern"
          header: "From"
          pattern: "(?i).*(AceMed|Medical|Healthcare|Clinic).*"
    score: -150
    description: "Medical and healthcare services"

  - name: "Small Business Professional Services"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "And"
          criteria:
            - type: "SenderPattern"
              pattern: ".*@gmail\\.com$"
            - type: "HeaderPattern"
              header: "From"
              pattern: "(?i).*(LLC|Inc|Corp|Solutions|Services|Roofing|Construction|Contractor).*"
        - type: "HeaderPattern"
          header: "From"
          pattern: "(?i).*(G&I Roofing|Professional Services).*"
    score: -100
    description: "Small business professional services using Gmail"

  - name: "Parts Express Electronics"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@.*partsexpress\\.com$"
        - type: "SenderPattern"
          pattern: "partsexpress@.*sendgrid\\.net$"
    score: -200
    description: "Parts Express electronics retailer"

  - name: "Medium Publishing Platform"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*medium\\.com$"
    score: -200
    description: "Medium publishing platform"

  - name: "USPS Informed Delivery"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*usps\\.com$"
    score: -200
    description: "Official USPS services"

  - name: "Lyft Rideshare"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*lyft.*\\.com$"
    score: -200
    description: "Lyft rideshare service"

  - name: "eFlorist Network"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*eflorist\\.com$"
    score: -200
    description: "eFlorist network florists"

  - name: "Poshmark Marketplace"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*poshmark\\.com$"
    score: -200
    description: "Poshmark marketplace platform"

  - name: "Quora Q&A Platform"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*quora\\.com$"
    score: -200
    description: "Quora question and answer platform"

  - name: "Empower Financial Services"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*empower\\.com$"
    score: -200
    description: "Empower financial advisory services"

  - name: "iHeart Media Services"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*iheart\\.com$"
    score: -200
    description: "iHeart radio and media services"

  - name: "Wayfair E-commerce"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*wayfair\\.com$"
    score: -200
    description: "Wayfair furniture and home goods retailer"

  - name: "BackerKit Crowdfunding"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*backerkit\\.com$"
    score: -150
    description: "BackerKit crowdfunding platform"

  - name: "British Airways Airlines"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*britishairways\\.com$"
    score: -150
    description: "British Airways airline"

  - name: "Oxford Club Investment"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*oxfordclub\\.com$"
    score: -150
    description: "Oxford Club investment newsletter"

  - name: "Think Vacuums Retail"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*thinkvacuums\\.com$"
    score: -150
    description: "Think Vacuums retail store"

  # Simple working BackerKit whitelist
  - name: "BackerKit Simple"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*\\.backerkit\\.com.*"
    score: -200
    description: "BackerKit all subdomains including s.backerkit.com"

  # Simple working patterns for remaining failures
  - name: "British Airways Simple"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*britishairways\\.com.*"
    score: -200
    description: "British Airways simple pattern"

  - name: "Oxford Club Simple"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*oxfordclub\\.com.*"
    score: -300
    description: "Oxford Club simple pattern (enhanced)"

  - name: "Legitimate Transaction Receipts"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(receipt|order.*confirmation|purchase.*confirmation|thank.*you.*order|shopping.*thank)"
            - type: "BodyPattern"
              pattern: "(?i).*(order.*number|transaction.*id|receipt.*number|purchase.*total)"
        - type: "HeaderPattern"
          header: "From"
          pattern: ".*@.*(walgreens|cvs|target|walmart|costco|amazon|bestbuy)\\.com.*"
    score: -150
    description: "Legitimate retail transaction receipts and confirmations"

  - name: "Think Vacuums Simple"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*thinkvacuums\\.com.*"
    score: -200
    description: "Think Vacuums simple pattern"

  - name: "UncommonGoods Simple"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*uncommongoods\\.com.*"
    score: -200
    description: "UncommonGoods simple pattern"

  # Fix remaining patterns
  - name: "British Airways BA Domain"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*\\.ba\\.com.*"
    score: -200
    description: "British Airways ba.com domain"

  - name: "Think Vacuums Case Insensitive"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: "(?i).*thinkvacuums\\.com.*"
    score: -200
    description: "Think Vacuums case insensitive"

  # DocuSign legitimate service
  - name: "DocuSign Service"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*docusign\\.com.*"
    score: -200
    description: "DocuSign electronic signature service"

  # Backstage job platform
  - name: "Backstage Jobs"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*backstage\\.com.*"
    score: -200
    description: "Backstage job platform service"

  # Labcorp medical laboratory
  - name: "Labcorp Medical"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*labcorp.*\\.com.*"
    score: -200
    description: "Labcorp medical laboratory service"

  # AdaptHealth medical equipment
  - name: "AdaptHealth Medical"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*adapthealth\\.com.*"
    score: -200
    description: "AdaptHealth medical equipment service"

  # Sense home energy monitoring
  - name: "Sense Energy Monitoring"
    enabled: true
    criteria:
      type: "SenderDomain"
      domains: ["sense.com", "ops.sense.com"]
    score: -200
    description: "Sense home energy monitoring service"

  # Major retailers and established businesses
  - name: "Major Retail Chains"
    enabled: true
    criteria:
      type: "SenderDomain"
      domains: [
        "amazon.com", "walmart.com", "target.com", "bestbuy.com", "homedepot.com",
        "lowes.com", "costco.com", "samsclub.com", "macys.com", "nordstrom.com",
        "kohls.com", "jcpenney.com", "overstock.com", "wayfair.com", "ikea.com",
        "williams-sonoma.com", "crateandbarrel.com", "potterybarn.com", "westelm.com"
      ]
    score: -100
    description: "Major established retail chains"

  - name: "Technology Companies"
    enabled: true
    criteria:
      type: "SenderDomain"
      domains: [
        "apple.com", "microsoft.com", "google.com", "amazon.com", "adobe.com",
        "salesforce.com", "oracle.com", "ibm.com", "intel.com", "nvidia.com",
        "dell.com", "hp.com", "lenovo.com", "cisco.com", "vmware.com"
      ]
    score: -100
    description: "Major technology companies"

  - name: "Financial Services"
    enabled: true
    criteria:
      type: "SenderDomain"
      domains: [
        "chase.com", "bankofamerica.com", "wellsfargo.com", "citi.com", "usbank.com",
        "capitalone.com", "discover.com", "americanexpress.com", "paypal.com",
        "stripe.com", "square.com", "venmo.com", "zelle.com", "fidelity.com"
      ]
    score: -150
    description: "Established financial services"

  - name: "Legitimate Email Service Providers"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SenderDomain"
          domains: [
            "mailchimp.com", "constantcontact.com", "sendgrid.net", "mailgun.org",
            "campaignmonitor.com", "aweber.com", "getresponse.com", "convertkit.com",
            "activecampaign.com", "hubspot.com", "pardot.com", "marketo.com"
          ]
        - type: "HeaderPattern"
          header: "Authentication-Results"
          pattern: "(?i)spf=pass"
        - type: "HeaderPattern"
          header: "List-Unsubscribe"
          pattern: ".*"
    score: -50
    description: "Legitimate email marketing service providers with authentication and unsubscribe"

  # DoorDash Order Confirmations
  - name: "DoorDash Order Confirmations"
    enabled: true
    criteria:
      type: "HeaderPattern"
      header: "From"
      pattern: ".*@doordash\\.com.*"
    score: -50
    description: "Legitimate DoorDash order confirmations and delivery updates"

  # Major Brand Marketing Infrastructure
  - name: "McDonald's Marketing Infrastructure"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@.*mcdonalds\\.(com|net)$"
        - type: "SenderPattern"
          pattern: ".*@.*m\\.mcdonalds\\.com$"
        - type: "HeaderPattern"
          header: "From"
          pattern: "(?i).*mcdonald.*"
    score: -50
    description: "McDonald's legitimate marketing emails"

  - name: "Netflix Marketing Infrastructure"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@.*netflix\\.(com|net)$"
        - type: "SenderPattern"
          pattern: ".*@.*members\\.netflix\\.com$"
        - type: "HeaderPattern"
          header: "From"
          pattern: "(?i).*netflix.*"
    score: -50
    description: "Netflix legitimate marketing emails"

  - name: "Newsletter Platforms"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@.*beehiiv\\.(com|net)$"
        - type: "SenderPattern"
          pattern: ".*@.*make\\.co$"
        - type: "HeaderPattern"
          header: "From"
          pattern: "(?i).*(newsletter|digest|update).*"
        - type: "HeaderPattern"
          header: "Subject"
          pattern: "(?i).*(newsletter|digest|weekly|monthly).*"
    score: -50
    description: "Legitimate newsletter platforms and publications"

  - name: "Make.co Newsletter"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@make\\.co$"
        - type: "HeaderPattern"
          header: "From"
          pattern: ".*make@make\\.co.*"
        - type: "HeaderPattern"
          header: "Reply-To"
          pattern: ".*@make\\.co.*"
    score: -100
    description: "Make.co technology newsletter - legitimate publication"
