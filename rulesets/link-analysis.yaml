name: "Link Analysis"
enabled: true
rules:
  - name: "Suspicious Link Patterns (External Only)"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "PhishingSuspiciousLinks"
          check_ip_addresses: false
          check_url_shorteners: true
          check_suspicious_tlds: true
          allow_sender_domain: true
          allow_email_infrastructure: true
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: "(?i).*@.*(ladyyum|humblebundle|wolfermans).*"
    score: 25
    description: "Suspicious link patterns from external domains (excludes legitimate retailers)"

  - name: "Free Email Provider Abuse"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@(outlook\\.com|gmail\\.com|yahoo\\.com|hotmail\\.com|aol\\.com)$"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*(salesforce\\.com|exacttarget\\.com|hubspot\\.com|mailchimp\\.com|constantcontact\\.com).*"
    score: 15
    description: "Abuse of free email providers for suspicious activities"

  - name: "Links Using IP Addresses"
    enabled: true
    criteria:
      type: "PhishingSuspiciousLinks"
      check_ip_addresses: true
      check_url_shorteners: false
      check_suspicious_tlds: false
      allow_sender_domain: false
      allow_email_infrastructure: false
    score: 50
    description: "IP addresses in links are always suspicious regardless of sender"

  - name: "Suspicious TLD Links (External Only)"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "PhishingSuspiciousLinks"
          check_ip_addresses: false
          check_url_shorteners: false
          check_suspicious_tlds: true
          allow_sender_domain: true
          allow_email_infrastructure: true
        - type: "Or"
          criteria:
            - type: "BodyPattern"
              pattern: "(?i).*(click.*here|verify.*account|urgent.*action|suspended.*account).*"
            - type: "BodyPattern"
              pattern: "(?i).*(limited.*time|expires.*today|act.*now|immediate.*action).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*(empower\\.com|iheart\\.com|wayfair\\.com|backerkit\\.com|salesforce\\.com|hubspot\\.com|mailchimp\\.com).*"
    score: 30
    description: "Suspicious TLD usage combined with urgency language (excludes legitimate businesses)"

  - name: "Phishing Link Text Patterns"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "BodyPattern"
          pattern: "(?i).*(click.*here|verify.*account|confirm.*identity|update.*payment).*"
        - type: "PhishingSuspiciousLinks"
          check_ip_addresses: true
          check_url_shorteners: true
          check_suspicious_tlds: true
          allow_sender_domain: false
          allow_email_infrastructure: false
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*(empower\\.com|iheart\\.com|wayfair\\.com|backerkit\\.com|salesforce\\.com|hubspot\\.com|mailchimp\\.com|wolfermans).*"
    score: 40
    description: "Phishing-style link text combined with suspicious URLs (excludes legitimate businesses)"
