name: "Financial Services"
enabled: true
rules:
  # High return investment scams
  - name: "Unrealistic return promises"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(earn|return|rate|yield|profit|investment|annuity|guaranteed.*income).*(\\d+\\.\\d+%|\\d+%|up to \\d+|\\$\\d+|\\d+.*USD|\\d+.*dollars?).*"
            - type: "BodyPattern"
              pattern: "(?i).*(earn|return|rate|yield|profit|investment|annuity|guaranteed.*income).*(\\d+\\.\\d+%|\\d+%|up to \\d+|\\$\\d+|\\d+.*USD|\\d+.*dollars?).*"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "And"
                criteria:
                  - type: "SenderPattern"
                    pattern: ".*@.*(disney|marvel|netflix|hulu|amazon|apple|microsoft|google|duluth|narvar|secretlab|oxford|nextdoor|sendgrid|butcherbox|becu|1800flowers|celebrations|eff|aclu|amnesty|greenpeace|redcross|unicef|oxfam|savethechildren|rejuvenation|rifftrax|bethesda|ecobee|wolfermans|wholefoodsmarket|coinbase|ally|walgreens|delta|united|american|southwest|jetblue|fiestatableware|kitchenaid|whirlpool|arbys|condenast|nationalgeographic|ecoflow)\\.(com|net|org)$"
                  - type: "Or"
                    criteria:
                      - type: "SubjectPattern"
                        pattern: "(?i).*(order.*confirmation|receipt|invoice.*#|off|discount|sale|clearance)"
                      - type: "BodyPattern"
                        pattern: "(?i).*(retail|store|shop|product|merchandise|bakery|home.*improvement|gaming|energy.*saving)"
              - type: "HeaderPattern"
                header: "From"
                pattern: "(?i).*(disney|marvel|netflix|hulu|amazon|apple|microsoft|google|duluth|narvar|secretlab|oxford|nextdoor|butcherbox|becu|1800flowers|celebrations|eff|aclu|amnesty|greenpeace|redcross|unicef|oxfam|savethechildren|rejuvenation|rifftrax|bethesda|ecobee|wolfermans|wholefoodsmarket|coinbase|ally|walgreens|delta|united|american|southwest|jetblue).*"
              - type: "HeaderPattern"
                header: "DKIM-Signature"
                pattern: ".*d=butcherbox\\.com.*"
              - type: "BodyPattern"
                pattern: "(?i).*(double.*impact|charitable.*donation|non.*profit|501\\(c\\)\\(3\\)|tax.*deductible|donate.*now)"
              - type: "Or"
                criteria:
                  - type: "SubjectPattern"
                    pattern: "(?i).*(miles|points|rewards|credit.*card|bonus.*miles|airline.*miles)"
                  - type: "BodyPattern"
                    pattern: "(?i).*(miles|points|rewards|credit.*card|bonus.*miles|airline.*miles|frequent.*flyer)"
    score: 120
    description: "Unrealistic financial return promises"

  # Loan and lending spam
  - name: "Refinance and mortgage spam"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(refinanc|mortgage|rate.*drop|lock.*in.*saving|fha.*rate).*"
            - type: "BodyPattern"
              pattern: "(?i).*(refinanc|mortgage|rate.*drop|lock.*in.*saving|fha.*rate).*"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "SenderPattern"
                pattern: ".*@.*(bankofamerica\\.com|chase\\.com|wellsfargo\\.com|quickenloans\\.com|rocketmortgage\\.com|lendingclub\\.com|quora\\.com|reddit\\.com|stackexchange\\.com|pmpress\\.org|quickbooks\\.com|intuit\\.com).*"
              - type: "HeaderPattern"
                header: "From"
                pattern: "(?i).*(PM Press|QuickBooks|Independent Publisher).*"
    score: 60
    description: "Refinance and mortgage spam from suspicious domains (excludes legitimate platforms)"

  - name: "Loan and lending spam"
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "BodyPattern"
              pattern: "(?i).*(loan.*options|financial.*goals|lending.*services|finance.*holdings|loan.*application|quick.*loan|easy.*loan|guaranteed.*loan|online.*loans.*up.*to|loans.*up.*to.*\\$|instant.*loan|cash.*advance|payday.*loan|personal.*loan.*up.*to).*"
            - type: "SubjectPattern"
              pattern: "(?i).*(loan|lending|finance|credit|funding|online.*loans.*up.*to|loans.*up.*to.*\\$|instant.*loan|cash.*advance|payday.*loan|personal.*loan.*up.*to).*"
            - type: "HeaderPattern"
              header: "From"
              pattern: "(?i).*(loan|lending|finance|funding|cash|credit).*"
        - type: "Or"
          criteria:
            - type: "SenderPattern"
              pattern: "(?i).*@.*(finance|loan|lending|credit|funding|capital).*"
            - type: "BodyPattern"
              pattern: "(?i).*(financial.*institution|loan.*provider|lending.*company|finance.*company).*"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "SenderPattern"
                pattern: ".*@.*(bankofamerica|chase|wellsfargo|citi|usbank|pnc|capitalone|discover|americanexpress|ally|marcus|sofi|lendingclub|prosper|upstart|rocket|quicken)\\.(com|net)$"
              - type: "SenderPattern"
                pattern: "(?i).*@.*(creditkarma|experian|equifax|transunion)\\.(com|net|org)$"
    score: 85
    description: "Unsolicited loan and lending offers (enhanced detection)"

  - name: "Seasonal loan scams"
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "BodyPattern"
              pattern: "(?i).*(christmas.*loan|holiday.*loan|santa.*loan|winter.*loan|seasonal.*loan|holiday.*cash|christmas.*cash|santa.*funding|holiday.*funding).*"
            - type: "SubjectPattern"
              pattern: "(?i).*(christmas.*loan|holiday.*loan|santa.*loan|winter.*loan|seasonal.*loan|holiday.*cash|christmas.*cash|santa.*funding|holiday.*funding).*"
            - type: "HeaderPattern"
              header: "From"
              pattern: "(?i).*(santa.*loan|holiday.*loan|christmas.*loan|seasonal.*funding).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*(bankofamerica|chase|wellsfargo|citi|usbank|pnc|capitalone|discover|americanexpress|ally|marcus|sofi)\\.(com|net)$"
    score: 120
    description: "Seasonal loan scams targeting holiday financial needs"

  - name: "Get rich quick scams"
    criteria:
      type: "Or"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(get.*rich.*quick|guaranteed.*income|make.*money.*fast|work.*from.*home.*opportunity|business.*opportunity!!).*"
        - type: "BodyPattern"
          pattern: "(?i).*(profit.*of.*\\$.*USD.*month|need.*your.*assistance.*supplying|raw.*material.*to.*our.*company|general.*business.*consultant|pharmaceutical.*company.*contacting|mutually.*beneficial.*to.*you|income.*generating.*business.*out.*of).*"
    score: 50
    description: "Business opportunity and get rich quick scam patterns (specific to scam language)"
  - name: "Advance fee fraud (419 scam)"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "BodyPattern"
          pattern: "(?i).*(fund.*management.*collaborator|deceased.*contractor|dormant.*account|unclaimed.*funds|business.*partner.*claim|inheritance.*claim|confidential.*business.*opportunity|west.*african.*bank|senior.*financial.*consultant|abandoned.*account|foreign.*contractor|government.*treasury|next.*of.*kin|reliable.*trustworthy.*partner|risk.*free.*legal|private.*email.*address|utmost.*confidentiality).*"
        - type: "SubjectPattern"
          pattern: "(?i).*(collaborator.*fund.*management|business.*opportunity|confidential.*proposal|urgent.*business|fund.*transfer|inheritance.*claim).*"
    score: 60
    description: "Classic advance fee fraud (419 scam) patterns"

  - name: "French rental payment redirect scam"
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(avis.*de.*rappel.*pour.*bail|paiement.*loyer|rappel.*bail).*"
            - type: "BodyPattern"
              pattern: "(?i).*(adresse.*interac.*pour.*le.*paiement.*des.*loyers|nouvelle.*adresse.*suivante|paiement.*à.*la.*nouvelle.*adresse).*"
        - type: "BodyPattern"
          pattern: "(?i).*(adresse.*bancaire.*interac|question.*de.*sécurité|réponse.*de.*sécurité).*"
    score: 75
    description: "French rental payment redirect scam targeting tenants"

  - name: "Fake investment collaboration scam"
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "BodyPattern"
              pattern: "(?i)(asset.{0,30}management.{0,30}firm|investment.{0,20}collaboration|joint.{0,20}ventures|financial.{0,20}sector.{0,20}experience|Foundation.{0,20}Asset.{0,20}Management|potential.{0,20}collaboration)"
            - type: "BodyPattern"
              pattern: "(?i)(real.{0,20}estate.{0,20}construction|manufacturing.{0,20}infrastructure|clean.{0,20}energy.{0,20}technology|healthcare.{0,20}agriculture.{0,20}mining|government.{0,20}projects)"
        - type: "Or"
          criteria:
            - type: "SenderPattern"
              pattern: ".*@.*(vumaq|temp|disposable|guerrillamail|10minutemail).*"
            - type: "BodyPattern"
              pattern: "(?i).*(Hong Kong|Singapore|Dubai|Switzerland).*"
    score: 80
    description: "Fake investment and asset management collaboration scams"

  - name: "Timeshare exit and vacation scams"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(exit.*timeshare|timeshare.*exit|vacation.*ownership|travel.*wherever|holiday.*season.*travel|timeshare.*relief|get.*out.*timeshare|cancel.*timeshare|timeshare.*cancellation).*"
        - type: "HeaderPattern"
          header: "From"
          pattern: "(?i).*exit.*timeshare.*"
        - type: "SenderPattern"
          pattern: ".*@.*(hoboband|timeshareexit|vacationexit|travelscam)\\.com.*"
    score: 75
    description: "Timeshare exit and vacation rental scams"

  - name: "W-8BEN tax compliance and residency scams"
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(w-8ben|w8ben|tax.*residency|residency.*notice|form.*w-8|tax.*compliance.*required|irs.*form.*required).*"
            - type: "BodyPattern"
              pattern: "(?i).*(w-8ben|w8ben|tax.*residency|residency.*notice|form.*w-8|tax.*compliance.*required|irs.*form.*required).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*(interactivebrokers|schwab|fidelity|vanguard|irs|treasury)\\.(com|gov)$"
    score: 75
    description: "Detects W-8BEN tax compliance and residency scams"

  - name: "Portuguese financial card eligibility scam"
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(elegibilidade.*cartão|cartão.*black|notificação.*oficial.*elegibilidade|protocolo.*\\d+).*"
            - type: "BodyPattern"
              pattern: "(?i).*(elegibilidade.*cartão|cartão.*black|notificação.*oficial.*elegibilidade|protocolo.*\\d+|bradesco.*amex|amex.*black).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*(bradesco|amex|americanexpress)\\.(com|com\\.br)$"
    score: 75
    description: "Detects Portuguese financial card eligibility scams"

  - name: "Estonian money transfer scam"
    criteria:
      type: "SubjectPattern"
      pattern: "(?i).*raha.*kantud.*"
    score: 75
    description: "Detects Estonian and international money transfer scams"
