name: "Enhanced Threat Detection"
enabled: true
rules:
  # CVS Medicare Phishing (100 points)
  - name: "CVS Medicare Phishing"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(cvs.*medicare|medicare.*cvs|pharmacy.*benefits).*"
        - type: "BodyPattern"
          pattern: "(?i).*(cvs.*medicare|medicare.*cvs|pharmacy.*benefits).*"
    score: 100
    description: "CVS Medicare impersonation attempts"

  # DocuSign Phishing (100 points)
  - name: "DocuSign Phishing"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(docusign|document.*sign|e-sign|electronic.*signature).*"
            - type: "BodyPattern"
              pattern: "(?i).*(docusign|document.*sign|e-sign|electronic.*signature).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*docusign\\.(com|net)$"
    score: 100
    description: "DocuSign impersonation from non-DocuSign domains"

  # Norton/Antivirus Fake Invoice (100 points)
  - name: "Norton Antivirus Fake Invoice"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(norton.*invoice|norton.*renewal|norton.*subscription|antivirus.*invoice).*"
        - type: "BodyPattern"
          pattern: "(?i).*(norton.*invoice|norton.*renewal|norton.*subscription|antivirus.*invoice).*"
    score: 100
    description: "Norton/antivirus fake invoice scams"

  # ShareFile Document Phishing (80 points)
  - name: "ShareFile Document Phishing"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(sharefile|shared.*file|file.*sharing).*"
            - type: "BodyPattern"
              pattern: "(?i).*(sharefile|shared.*file|file.*sharing).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*(sharefile|citrix)\\.(com|net)$"
    score: 80
    description: "ShareFile document sharing phishing"

  # Generic Health Medicare Spam (60 points)
  - name: "Generic Health Medicare Spam"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(medicare.*plan|health.*insurance|compare.*providers|auto.*insurance.*providers).*"
        - type: "BodyPattern"
          pattern: "(?i).*(medicare.*plan|health.*insurance|compare.*providers|auto.*insurance.*providers).*"
    score: 60
    description: "Generic health and insurance spam"

  # Health Miracle Cure Spam (100 points)
  - name: "Health Miracle Cure Spam"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(miracle.*cure|doctors.*hate|chronic.*pain|breakthrough.*cure).*"
        - type: "BodyPattern"
          pattern: "(?i).*(miracle.*cure|doctors.*hate|chronic.*pain|breakthrough.*cure).*"
    score: 100
    description: "Health miracle cure and medical misinformation spam"

  # Mailer Daemon Spoofing (150 points)
  - name: "Mailer Daemon Spoofing"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "HeaderPattern"
          header: "Return-Path"
          pattern: ".*MAILER-DAEMON.*"
        - type: "Or"
          criteria:
            - type: "HeaderPattern"
              header: "Authentication-Results"
              pattern: "dkim=fail"
            - type: "SubjectPattern"
              pattern: ".*=\\?UTF-8\\?B\\?.*"
    score: 150
    description: "Spoofed mailer daemon messages with authentication failures"
