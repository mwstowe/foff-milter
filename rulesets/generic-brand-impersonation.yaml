name: "Generic Brand Impersonation"
enabled: true  # RE-ENABLED - Simplified version needs refinement
rules:
  # AARP brand impersonation - high value target
  - name: "AARP brand impersonation"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SenderPattern"
              pattern: "(?i).*aarp.*"
            - type: "SubjectPattern"
              pattern: "(?i).*aarp.*"
            - type: "HeaderPattern"
              header: "From"
              pattern: "(?i).*aarp.*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*aarp\\.(org|com)$"
    score: 150
    description: "AARP brand impersonation from non-AARP domains"

  # Authentication failure + brand claims
  - name: "Brand claims with authentication failure"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "HeaderPattern"
              header: "Authentication-Results"
              pattern: "dkim=fail"
            - type: "HeaderPattern"
              header: "Authentication-Results"
              pattern: "spf=fail"
        - type: "Or"
          criteria:
            - type: "SenderPattern"
              pattern: "(?i).*(amazon|apple|microsoft|google|facebook|paypal|aarp|walmart|target|netflix|disney|fedex|ups|visa|chase|bank|mcdonalds).*"
            - type: "SubjectPattern"
              pattern: "(?i).*(membership|account|security|verify|update|suspended).*"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "SenderPattern"
                pattern: ".*@.*(sparkpostmail|sendgrid|mailchimp|constantcontact|amazonses|mailgun)\\.(com|net|org)$"
              - type: "HeaderPattern"
                header: "From"
                pattern: "(?i).*(newsletter|digest|marketing|promotional).*"
    score: 75
    description: "Brand claims with failed authentication (excluding legitimate ESPs)"

  # HR Document Sharing Phishing - Critical BEC Pattern
  - name: "HR Document Sharing Phishing"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(\\w+\\.com\\s+hr.*shared|\\w+\\.com\\s+hr.*document|salary.*review.*document|incentive.*overview.*document|payroll.*document.*shared).*"
            - type: "BodyPattern"
              pattern: "(?i).*(\\w+\\.com\\s+hr.*shared|salary.*review.*document|incentive.*overview.*document|payroll.*document.*shared).*"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "SenderPattern"
                pattern: ".*@.*(hr|payroll|benefits|workday|adp|bamboohr|docusign|sharepoint|onedrive|dropbox)\\.(com|net|org)$"
              - type: "HeaderPattern"
                header: "From"
                pattern: "(?i).*(docusign|sharepoint|onedrive|dropbox|google drive).*"
    score: 200
    description: "Specific HR document sharing phishing with domain claims"

  # Generic brand impersonation - any known brand from suspicious domain
  - name: "Known brand from suspicious domain"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: "(?i).*(amazon|apple|microsoft|google|facebook|paypal|ebay|walmart|target|costco|bestbuy|homedepot|lowes|tmobile|t-mobile|verizon|att|sprint|netflix|disney|samsung|sony|nike|adidas|mcdonalds|starbucks|fedex|ups|usps|dhl|visa|mastercard|chase|bankofamerica|wells.*fargo|citibank|american.*express|norton|aaa|twilio|sendgrid).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*(amazon|apple|microsoft|google|facebook|paypal|ebay|walmart|target|costco|bestbuy|homedepot|lowes|tmobile|verizon|att|sprint|netflix|disney|samsung|sony|nike|adidas|mcdonalds|starbucks|fedex|ups|usps|dhl|visa|mastercard|chase|bankofamerica|wellsfargo|citibank|americanexpress|norton|aaa|twilio|sendgrid|sparkpostmail|mailchimp|constantcontact|amazonses)\\.(com|net|org)$"
    score: 75
    description: "Brand name in sender but not from official domain"

  # Brand + urgent/deal keywords from suspicious domains
  - name: "Brand with urgency from suspicious domain"
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SenderPattern"
              pattern: "(?i).*(amazon|apple|microsoft|google|paypal|walmart|target|tmobile|verizon|netflix|disney|fedex|ups|visa|chase).*"
            - type: "SubjectPattern"
              pattern: "(?i).*(amazon|apple|microsoft|google|paypal|walmart|target|tmobile|verizon|netflix|disney|fedex|ups|visa|chase).*"
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(urgent|immediate|expires|limited.*time|act.*now|final.*notice|suspended|verify|update|confirm|security.*alert|unauthorized).*"
            - type: "SubjectPattern"
              pattern: "(?i).*(deal|offer|discount|save|free|gift|reward|winner|prize|congratulations).*"
    score: 115
    description: "Brand impersonation with urgency/deals (relies on shared TLD detection)"

  # Generic suspicious brand-like patterns
  - name: "Suspicious brand-like patterns"
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: "(?i).*[a-z]+(deal|offer|gift|reward|tech|mobile|store|shop|service|support|account|security|update|verify|confirm).*@.*"
    score: 55
    description: "Generic brand-like patterns (relies on shared TLD detection)"

  # Brand impersonation from unrelated .com domains
  - name: "Brand impersonation from unrelated domains"
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: "(?i).*(amazon|apple|microsoft|google|paypal|walmart|target|tmobile|verizon|netflix|disney|fedex|ups|visa|chase|aaa).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*(netatmo)\\.(com|net|org)$"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*(amazon|apple|microsoft|google|paypal|walmart|target|tmobile|verizon|netflix|disney|fedex|ups|visa|chase|aaa|secretlab|think|netatmo|business|mcdonalds|members\\.netflix|m\\.mcdonalds)\\.(com|net|org)$"
    score: 8
    description: "Major brand names from unrelated domains (even .com)"

  # Legitimate domain override (negative scoring)
  - name: "Legitimate brand domains override"
    criteria:
      type: "SenderPattern"
      pattern: ".*@(amazon|apple|microsoft|google|facebook|paypal|ebay|walmart|target|costco|bestbuy|homedepot|lowes|tmobile|t-mobile|verizon|att|sprint|netflix|disney|samsung|sony|nike|adidas|mcdonalds|starbucks|fedex|ups|usps|dhl|visa|mastercard|chase|bankofamerica|wellsfargo|citi|americanexpress|twilio|sendgrid)\\.(com|net|org)$"
    score: -30
    description: "Override for legitimate brand domains (excludes tenant domains)"

  # AAA brand impersonation (high-value target)
  - name: "AAA brand impersonation"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: "(?i).*aaa.*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*aaa\\.(com|net|org)$"
    score: 25
    description: "AAA brand impersonation from non-AAA domains"

  # Milwaukee Tools brand impersonation
  - name: "Milwaukee Tools brand impersonation"
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: "(?i).*milwaukee.*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*milwaukee.*\\.(com|net|org)$"
    score: 50
    description: "Milwaukee Tools brand impersonation from non-Milwaukee domains"

  # O'Reilly Auto Parts brand impersonation
  - name: "O'Reilly brand impersonation"
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: "(?i).*(oreilly|o'reilly).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*oreilly.*\\.(com|net|org)$"
    score: 50
    description: "O'Reilly Auto Parts brand impersonation"

  # Stanley Tools brand impersonation
  - name: "Stanley Tools brand impersonation"
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: "(?i).*stanley.*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*stanley.*\\.(com|net|org)$"
    score: 50
    description: "Stanley Tools brand impersonation"

  # WeTransfer brand impersonation
  - name: "WeTransfer brand impersonation"
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: "(?i).*wetransfer.*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*wetransfer\\.(com|net)$"
    score: 55
    description: "WeTransfer brand impersonation"

  # Yeti brand impersonation
  - name: "Yeti brand impersonation"
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: "(?i).*yeti.*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*yeti\\.(com|net)$"
    score: 50
    description: "Yeti brand impersonation"
