name: "Simplified Phishing Detection"
enabled: true
rules:
  # Critical Phishing: Credential Harvesting (300 points)
  - name: "Credential Harvesting"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(verify.*account|update.*password|confirm.*identity|security.*alert|account.*locked|suspicious.*activity).*"
        - type: "BodyPattern"
          pattern: "(?i).*(verify.*account|update.*password|confirm.*identity|security.*alert|account.*locked|verify.*now).*"
    score: 300
    description: "Critical: Credential harvesting attempts"

  # High Phishing: Financial Fraud (250 points)
  - name: "Financial Fraud"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(payment.*failed|account.*suspended|billing.*issue|invoice.*overdue|refund.*pending).*"
            - type: "BodyPattern"
              pattern: "(?i).*(payment.*failed|account.*suspended|billing.*issue|invoice.*overdue|refund.*pending).*"
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(urgent|immediate|expires.*today|act.*now|final.*notice).*"
            - type: "BodyPattern"
              pattern: "(?i).*(urgent|immediate|expires.*today|act.*now|final.*notice).*"
    score: 250
    description: "High: Financial fraud with urgency"

  # Moderate Phishing: Suspicious Links (150 points)
  - name: "Suspicious Links"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "BodyPattern"
          pattern: "(?i).*https?://[^/]*\\.(tk|ml|ga|cf|pw|top)/.*"
        - type: "BodyPattern"
          pattern: "(?i).*https?://[^/]*-[a-z0-9]{10,}\\.[^/]*"
        - type: "BodyPattern"
          pattern: "(?i).*https?://[^/]*[0-9]{8,}\\.[^/]*"
    score: 150
    description: "Moderate: Suspicious URL patterns"

  # Business Email Compromise (200 points)
  - name: "Business Email Compromise"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(w-2.*form|tax.*document|payroll.*update|employee.*handbook|salary.*adjustment).*"
        - type: "BodyPattern"
          pattern: "(?i).*(w-2.*form|tax.*document|payroll.*update|employee.*handbook|salary.*adjustment).*"
    score: 200
    description: "Business Email Compromise patterns"

  # Domain Spoofing (175 points)
  - name: "Domain Spoofing"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: "(?i).*(amazon|paypal|microsoft|google|apple|netflix|chase|visa).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*(amazon|paypal|microsoft|google|apple|netflix|chase|visa)\\.(com|org)$"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*(amazonses|sendgrid|mailchimp|sparkpostmail)\\.(com|net)$"
    score: 175
    description: "Domain spoofing of major brands"
