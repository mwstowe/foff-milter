name: "Commerce Threats"
enabled: true
rules:
  # Brand-domain mismatch detection
  - name: "Product brand domain mismatch"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "HeaderPattern"
          header: "From"
          pattern: "(?i).*(knife|chef|kitchen|cooking|culinary|cutlery|blade|steel|ceramic|santoku|cleaver).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*(kitchen|chef|culinary|cooking|knife|cutlery|blade|steel|wusthof|henckels|global|shun|victorinox|kitchenaid|whirlpool)\\.(com|net|org)$"
    score: 40
    description: "Kitchen/cooking product from non-culinary domain"

  # Fake surveys and contests
  - name: "Fake brand surveys and contests"
    enabled: true
    criteria:
      type: "SubjectPattern"
      pattern: "(?i).*(survey.*chance.*win|complete.*survey.*win|feedback.*win|customer.*survey.*prize|survey.*gift|survey.*reward|survey.*car.*kit|survey.*emergency.*kit).*"
    score: 80
    description: "Fake brand surveys and contest scams"

  # Black Friday and fake sales
  - name: "Black Friday and fake savings scams"
    criteria:
      type: "And"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(black.*friday|cyber.*monday|huge.*savings|massive.*discount|limited.*time.*offer|act.*now.*save|don't.*miss.*out|final.*hours|last.*chance|up.*to.*\\d+%.*off|\\d+%.*off|save.*up.*to.*\\$\\d+|get.*\\d+%.*off).*"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "SenderDomain"
                domains: ["williams-sonoma.com", "tokyo-tiger.com", "uncommongoods.com", "backerkit.com", "kickstarter.com", "bedjet.com", "humblebundle.com", "wolfermans.com", "wolfermans-email.com", "eff.org", "gog.com", "email3.gog.com", "nedm.asus.com", "asus.com", "kitchenaid.com", "dm.kitchenaid.com", "whirlpool.com", "arbys.com", "emails.arbys.com", "condenast.com", "eml.condenast.com", "nationalgeographic.com", "email.nationalgeographic.com"]
              - type: "SenderPattern"
                pattern: ".*@(bedjet\\.com|tokyo-tiger\\.com|humblebundle\\.com|wolfermans.*\\.com|eff\\.org|.*gog\\.com|biqu\\.equipment|bigtreetech\\.com|.*costco\\.com.*|.*delta\\.com.*|.*sendgrid\\.net.*|.*klaviyo.*\\.com.*|.*kitchenaid\\.com.*|.*whirlpool\\.com.*|.*arbys\\.com.*|.*condenast\\.com.*|.*nationalgeographic\\.com.*).*"
              - type: "BodyPattern"
                pattern: "(?i).*(national.*pastry.*day|celebrate.*national.*day|established.*bakery|gourmet.*bakery|artisan.*baked)"
    score: 65
    description: "Black Friday and fake promotional scams (excludes legitimate retailers)"

  # Beauty and cosmetic scams
  - name: "Beauty and cosmetic product spam"
    criteria:
      type: "Or"
      criteria:
        - type: "And"
          criteria:
            - type: "BodyPattern"
              pattern: "(?i).*(no.*mascara.*trick|thick.*luscious.*lashes|fake.*lashes.*extensions|curly.*beautiful.*lashes|eyelash.*growth.*serum|miracle.*beauty.*secret).*"
            - type: "SenderPattern"
              pattern: ".*@.*\\.(shop|online|store)$"
        - type: "SubjectPattern"
          pattern: "(?i).*(beauty.*secret|lash.*trick|mascara.*alternative|eyelash.*growth|thick.*luscious.*lashes).*"
    score: 60
    description: "Beauty and cosmetic product promotion spam"

  # Home improvement scams
  - name: "Home improvement and gutter protection scams"
    criteria:
      type: "SubjectPattern"
      pattern: "(?i).*(gutter.*protection|leaf.*guard|home.*improvement|roofing.*special|siding.*deal|window.*replacement|solar.*panels|energy.*savings).*"
    score: 80
    description: "Home improvement and gutter protection scams"

  # General product spam
  - name: "General product spam"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(introducing.*!|small yet powerful|heats up.*in.*minutes|revolutionary.*product|amazing.*device).*"
            - type: "BodyPattern"
              pattern: "(?i).*(introducing.*!|small yet powerful|heats up.*in.*minutes|revolutionary.*product|amazing.*device).*"
        - type: "SenderPattern"
          pattern: ".*@.*\\.(sa\\.com|ninja.*\\.(com|net)|service\\.(com|net)|mail\\.(com|net|org))$"
    score: 65
    description: "General product spam with suspicious domains"

  # Specific product sales spam
  - name: "Heated vest and winter gear spam"
    criteria:
      type: "Or"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(heated.*vest|warming.*vest|winter.*essential|stay.*warm.*style|heated.*jacket|thermal.*vest).*"
        - type: "BodyPattern"
          pattern: "(?i).*(heated.*vest|warming.*vest|winter.*essential|stay.*warm.*style|heated.*jacket|thermal.*vest).*"
    score: 85
    description: "Heated vest and winter gear product spam"

  - name: "Sleep and bedding product spam"
    criteria:
      type: "Or"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(better.*sleep|miracle.*sleep|sleep.*better|gift.*sleep|sleep.*solution|bedding.*sale).*"
        - type: "BodyPattern"
          pattern: "(?i).*(better.*sleep|miracle.*sleep|sleep.*better|gift.*sleep|sleep.*solution|bedding.*sale).*"
    score: 85
    description: "Sleep and bedding product spam"

  - name: "Flooring and home upgrade spam"
    criteria:
      type: "Or"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(upgrade.*floors|flooring.*sale|floor.*upgrade|home.*flooring|new.*floors).*"
        - type: "BodyPattern"
          pattern: "(?i).*(upgrade.*floors|flooring.*sale|floor.*upgrade|home.*flooring|new.*floors).*"
    score: 85
    description: "Flooring and home upgrade product spam"

  # Free product scams
  - name: "Free product scams"
    enabled: true
    criteria:
      type: "SubjectPattern"
      pattern: "(?i).*(free.*sample|free.*trial|free.*gift|no.*cost|complimentary|risk.*free).*"
    score: 45
    description: "Free product scams (relies on shared TLD detection)"

  # Shopping and marketplace fraud
  - name: "Shopping marketplace fraud"
    criteria:
      type: "SubjectPattern"
      pattern: "(?i).*(amazing.*deal|incredible.*price|wholesale.*direct|factory.*outlet|liquidation.*sale|going.*out.*business|everything.*must.*go).*"
    score: 70
    description: "Shopping marketplace and liquidation fraud"

  # Brand impersonation in commerce
  - name: "OneStopPlus customer service impersonation"
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: ".*OneStopPlus.*"
        - type: "SubjectPattern"
          pattern: ".*Items.*never.*arrived.*"
    score: 60
    description: "OneStopPlus impersonation scam"

  - name: "ZoomCare marketing impersonation"
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: ".*ZoomCare.*"
        - type: "SubjectPattern"
          pattern: ".*flu.*shot.*"
    score: 35
    description: "ZoomCare impersonation scam"

  - name: "Email List Selling Spam"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i)(email.{0,10}list|email.{0,10}blast|mx.{0,10}test)"
            - type: "BodyPattern"
              pattern: "(?i)(email.{0,10}list|email.{0,10}blast|mx.{0,10}test)"
        - type: "BodyPattern"
          pattern: "(?i)(fresh.{0,10}email|updated.{0,10}email|replacement.{0,10}policy|100%.{0,10}(fresh|updated|mx.{0,10}test))"
    score: 100
    description: "Commercial email list selling and bulk email services"

  - name: "Bulk Email Service Promotion"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i)(email.{0,10}list|bulk.{0,10}email|mass.{0,10}mail)"
        - type: "BodyPattern"
          pattern: "(?i)(talk.{0,10}us.{0,10}whatsapp|whatsapp.{0,10}contact)"
    score: 75
    description: "Bulk email service and WhatsApp contact spam"

  - name: "Spam Infrastructure References"
    enabled: true
    criteria:
      type: "BodyPattern"
      pattern: "(?i)(smtp\\.[^:]+:\\d+|socks5?:\\d+|127\\.0\\.0\\.1:\\d+)"
    score: 50
    description: "References to spam infrastructure and proxy servers"
