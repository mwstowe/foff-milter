name: "Integration"
enabled: true
rules:
  - name: "Cloud Storage Phishing"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(dropbox.*shared|google.*drive.*shared|onedrive.*shared|file.*shared.*you|document.*shared|shared.*folder|download.*file|view.*document).*"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "SenderPattern"
                pattern: ".*@.*(charmtracker|medical|healthcare|clinic|hospital|ehr)\\.(com|net|org)$"
              - type: "HeaderPattern"
                header: "From"
                pattern: "(?i).*(AceMed|Medical|Healthcare|Clinic|Hospital|EHR|Patient Portal).*"
    score: 35
    description: "Fake cloud storage sharing notifications (excluding legitimate medical services)"

  - name: "Payment Service Abuse"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(paypal.*payment|stripe.*payment|square.*payment|payment.*received|money.*sent|invoice.*paid|transaction.*complete|refund.*processed).*"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "SenderPattern"
                pattern: "(?i).*@.*apple.*"
              - type: "SenderPattern"
                pattern: "(?i).*@.*paypal\\.(com|net)$"
              - type: "SenderPattern"
                pattern: "(?i).*@.*stripe\\.(com|net)$"
    score: 40
    description: "Fake payment service notifications"

  - name: "Social Media Impersonation"
    enabled: true
    criteria:
      type: "SubjectPattern"
      pattern: "(?i).*(facebook.*notification|twitter.*mention|linkedin.*message|instagram.*follow|social.*media.*alert|friend.*request|connection.*request).*"
    score: 30
    description: "Fake social media notifications"

  - name: "GitHub/Developer Service Abuse"
    enabled: true
    criteria:
      type: "SubjectPattern"
      pattern: "(?i).*(github.*notification|pull.*request|code.*review|repository.*access|developer.*alert|api.*key|security.*vulnerability).*"
    score: 25
    description: "Fake developer service notifications"

  - name: "Shipping/Delivery Scams"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(package.*delivery|shipment.*notification|fedex.*delivery|ups.*package|dhl.*shipment|delivery.*failed|package.*held|customs.*fee).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*(ups\\.com|fedex\\.com|dhl\\.com|usps\\.com|amazon\\.com)$"
    score: 45
    description: "Fake shipping and delivery notifications"

  - name: "Subscription Service Abuse"
    enabled: true
    criteria:
      type: "SubjectPattern"
      pattern: "(?i).*(netflix.*account|spotify.*premium|amazon.*prime|subscription.*expired|billing.*failed|auto.*renewal|cancel.*subscription).*"
    score: 35
    description: "Fake subscription service notifications"

  - name: "Legitimate Service Domain Mismatch"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "And"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(paypal|amazon|microsoft|google|apple|facebook|netflix|dropbox).*"
            - type: "Not"
              criteria:
                type: "Or"
                criteria:
                  - type: "SubjectPattern"
                    pattern: "(?i).*(discussion|question|ask|answer|digest|newsletter|news|article|update|offer\\?|did you|have you).*"
                  - type: "SenderPattern"
                    pattern: ".*@.*(quora|reddit|news|newsletter|digest)\\.(com|net|org)$"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "SenderPattern"
                pattern: ".*@quora\\.com$"
              - type: "SenderPattern"
                pattern: ".*@.*(paypal|amazon|microsoft|google|apple|facebook|netflix|dropbox)\\.(com|net|org)$"
              - type: "SenderPattern"
                pattern: ".*@.*woot\\.com$"
              - type: "SenderPattern"
                pattern: ".*@.*sparkpostmail\\.com$"
              - type: "SenderPattern"
                pattern: ".*@.*ifttt\\.com$"
              - type: "SenderPattern"
                pattern: ".*@.*post\\.applecard\\.apple$"
              - type: "SenderPattern"
                pattern: ".*@.*sendgrid\\.net$"
              - type: "SenderPattern"
                pattern: ".*@.*fidelity\\.com$"
              - type: "SenderPattern"
                pattern: ".*@.*services\\.discover\\.com$"
              - type: "SenderPattern"
                pattern: ".*@.*amazonmusic\\.com$"
              - type: "SenderPattern"
                pattern: ".*@.*quora\\.com$"
              - type: "SenderPattern"
                pattern: ".*@.*thinkvacuums\\.com$"
              - type: "SenderPattern"
                pattern: ".*@.*oxfordclub\\.com$"
              - type: "SenderPattern"
                pattern: ".*@.*empower\\.com$"
              - type: "SenderPattern"
                pattern: ".*@.*netatmo\\.com$"
              - type: "SenderPattern"
                pattern: ".*@.*filtersfast\\.com$"
              - type: "SenderPattern"
                pattern: ".*@.*ally\\.com$"
    score: 50
    description: "Subject mentions legitimate service but sender domain doesn't match (excludes legitimate resellers and third-party services)"

  - name: "Organization Impersonation"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*baddomain\\.com\\s+(hr|it|admin|support|team).*"
            - type: "BodyPattern"
              pattern: "(?i).*baddomain\\.com\\s+(hr|it|admin|support|team).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@baddomain\\.com$"
    score: 150
    description: "Claims to be from baddomain.com but sender domain doesn't match"
