name: "Performance"
enabled: true
rules:
  - name: "Business System Fast Path"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "HeaderPattern"
          header: "x-netsuite"
          pattern: ".*"
        - type: "SenderPattern"
          pattern: ".*@.*(netsuite\\.com|oracleemaildelivery\\.com)$"
        - type: "SenderPattern"
          pattern: ".*@.*salesforce\\.com$"
        - type: "SenderPattern"
          pattern: ".*@.*quickbooks\\.com$"
        - type: "HeaderPattern"
          header: "X-Mailer"
          pattern: ".*NetSuite.*"
    score: -50
    description: "Fast path for legitimate business systems like NetSuite, Salesforce, QuickBooks"

  - name: "Trusted Domain Fast Path"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@(amazon\\.com|microsoft\\.com|apple\\.com|google\\.com|paypal\\.com|ebay\\.com|linkedin\\.com|twitter\\.com|facebook\\.com)$"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "AttachmentOnlyEmail"
              - type: "SubjectPattern"
                pattern: "(?i).*(invoice|billing|urgent|verify|suspend|click|winner|congratulations).*"
    score: -30
    description: "Fast path for trusted corporate domains without suspicious patterns (excludes subdomains like onmicrosoft.com)"

  - name: "Obvious Spam Early Rejection"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(viagra|cialis|lottery.*winner|nigerian.*prince|inheritance.*fund|click.*here.*now|act.*now.*urgent|urgent.*response.*required).*"
        - type: "Not"
          criteria:
            type: "And"
            criteria:
              - type: "HeaderPattern"
                header: "List-Unsubscribe"
                pattern: ".*"
              - type: "HeaderPattern"
                header: "DKIM-Signature"
                pattern: ".*"
    score: 100
    description: "Early rejection for blatantly obvious spam patterns, but not legitimate marketing with proper headers"

  - name: "VIP Sender Priority"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*(government\\.gov|edu|mil|bank.*com|.*bank\\.com)$"
    score: -30
    description: "Priority processing for government, education, military, and banking domains"

  - name: "Resource Intensive Pattern Limit"
    enabled: true
    criteria:
      type: "SubjectPattern"
      pattern: ".{200,}"
    score: 15
    description: "Flag extremely long subjects that may cause processing delays"

  - name: "Bulk Email Quick Detection"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "HeaderPattern"
          header: "List-Unsubscribe"
          pattern: ".*"
        - type: "Or"
          criteria:
            - type: "SenderPattern"
              pattern: ".*@.*(empower\\.com|iheart\\.com|wayfair\\.com|backerkit\\.com|salesforce\\.com|mailchimp\\.com|constantcontact\\.com|hubspot\\.com|netflix\\.com|mcdonalds\\.com|beehiiv\\.com|make\\.co|amazonses\\.com|sendgrid\\.net|sparkpostmail\\.com).*"
            - type: "HeaderPattern"
              header: "From"
              pattern: "(?i).*(newsletter|digest|update|notification|automated|system|marketing).*"
            - type: "HeaderPattern"
              header: "List-Unsubscribe-Post"
              pattern: ".*"
            - type: "HeaderPattern"
              header: "Precedence"
              pattern: "(?i)bulk"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@(gmail\\.com|yahoo\\.com|hotmail\\.com|outlook\\.com)$"
    score: -35
    description: "Enhanced accept for legitimate bulk emails with unsubscribe headers"
    description: "Enhanced accept for legitimate bulk emails with validated unsubscribe headers"

  - name: "Empty Content Quick Reject"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SubjectPattern"
          pattern: "^\\s*$"
        - type: "EmptyContentEmail"
    score: 80
    description: "Quick rejection for completely empty emails"

  - name: "Attachment Bomb Prevention"
    enabled: true
    criteria:
      type: "HeaderPattern"
      header: "Content-Length"
      pattern: "[5-9][0-9]{7,}|[1-9][0-9]{8,}"
    score: 40
    description: "Prevent processing of extremely large emails (50MB+)"
