name: "Context Adjustments"
enabled: true
rules:
  # Reduce commercial scoring for authenticated senders
  - name: "Authenticated Commercial Content Adjustment"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "HeaderPattern"
          header: "Authentication-Results"
          pattern: "(?i)(dmarc=pass|spf=pass)"
        - type: "HeaderPattern"
          header: "List-Unsubscribe"
          pattern: ".*"
        - type: "BodyPattern"
          pattern: "(?i)(sale|discount|offer|deal|promotion|limited.*time)"
        - type: "SenderPattern"
          pattern: ".*@.*(amazon|ebay|etsy|shopify|target|walmart|bestbuy|homedepot|lowes|macys|nordstrom|kohls|disney|kickstarter|eyebuydirect|torrid)\\.(com|net|org)$"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*(yournconcierge|cardiovascular|internetdisaster|familyandfriendsllc|ybokjraxqz|solecomfort)\\.(com|net|org|top|lat)$"
    score: -30
    description: "Reduce commercial scoring ONLY for authenticated emails from known legitimate retailers"

  # Seasonal content allowances
  - name: "Seasonal Sales from Established Domains"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "HeaderPattern"
          header: "Authentication-Results"
          pattern: "(?i)spf=pass"
        - type: "SenderDomain"
          domains: [
            "amazon.com", "walmart.com", "target.com", "bestbuy.com", "macys.com",
            "nordstrom.com", "kohls.com", "williams-sonoma.com", "wayfair.com"
          ]
        - type: "SubjectPattern"
          pattern: "(?i)(black.*friday|cyber.*monday|holiday.*sale|christmas.*sale|new.*year.*sale)"
    score: -40
    description: "Allow seasonal promotional content from established retailers"

  # Professional communication pattern rewards
  - name: "Professional Newsletter Format"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "HeaderPattern"
          header: "List-Unsubscribe"
          pattern: ".*"
        - type: "BodyPattern"
          pattern: "(?i)(newsletter|update|news|announcement)"
        - type: "BodyPattern"
          pattern: "(?i)\\d+.*\\w+.*(street|ave|road|blvd|drive|way|lane|court|place|suite|floor).*\\w+.*\\d{5}"
        - type: "Not"
          criteria:
            type: "BodyPattern"
            pattern: "(?i)(urgent|act.*now|limited.*time|expires.*today|don't.*miss|hurry)"
    score: -35
    description: "Professional newsletter format with address and no urgency tactics"

  # Established business relationship indicators
  - name: "Customer Account Communications"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "HeaderPattern"
          header: "Authentication-Results"
          pattern: "(?i)spf=pass"
        - type: "BodyPattern"
          pattern: "(?i)(account|order|purchase|receipt|invoice|statement|billing)"
        - type: "Not"
          criteria:
            type: "BodyPattern"
            pattern: "(?i)(click.*here.*verify|suspended|locked|expired|update.*payment)"
    score: -45
    description: "Legitimate customer account communications"

  # Government and educational institution rewards
  - name: "Cultural and Educational Institutions"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@.*(museum|library|cultural|arts|symphony|orchestra|theater|theatre).*\\.(org|edu)$"
        - type: "SenderPattern"
          pattern: ".*@nordicmuseum\\.org$"
    score: -75
    description: "Museums, libraries, and cultural institutions"

  - name: "Government and Educational Institutions"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*\\.(gov|edu|mil)$"
    score: -100
    description: "Government, educational, and military institutions"

  # Non-profit organization rewards
  - name: "Non-Profit Organizations"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@.*\\.org$"
        - type: "HeaderPattern"
          header: "Authentication-Results"
          pattern: "(?i)spf=pass"
        - type: "BodyPattern"
          pattern: "(?i)(donate|donation|charity|non.?profit|foundation|volunteer)"
    score: -50
    description: "Authenticated non-profit organizations"
