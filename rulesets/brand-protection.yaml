name: "Brand Protection"
enabled: true
rules:
  # HR Document Sharing Phishing (BEC)
  - name: "HR Document Sharing Phishing"
    enabled: true
    criteria:
      type: And
      criteria:
        - type: Or
          criteria:
            - type: SubjectPattern
              pattern: "(?i).*(hr.*shared|hr.*document|salary.*review|incentive.*overview|payroll.*document|employee.*handbook).*"
            - type: BodyPattern
              pattern: "(?i).*(hr.*department|human.*resources|salary.*information|payroll.*details|employee.*benefits).*"
        - type: Not
          criteria:
            type: Or
            criteria:
              - type: SenderPattern
                pattern: ".*@.*(company\\.com|organization\\.org|legitimate\\.edu)$"
              - type: SenderPattern
                pattern: ".*@.*(govdelivery|public\\.govdelivery|capitaloneshopping)\\.(com|net|org)$"
    score: 200
    description: "Business Email Compromise targeting HR/payroll themes"

  # Organization Impersonation
  - name: "Organization Impersonation"
    enabled: true
    criteria:
      type: And
      criteria:
        - type: Or
          criteria:
            - type: SubjectPattern
              pattern: "(?i).*baddomain\\.com\\s+(hr|it|admin|support|team).*"
            - type: BodyPattern
              pattern: "(?i).*baddomain\\.com.*(department|team|staff|employee).*"
        - type: Not
          criteria:
            type: SenderPattern
            pattern: ".*@baddomain\\.com$"
    score: 150
    description: "Domain mismatch impersonation detection"

  # Generic brand impersonation
  - name: "Generic brand impersonation"
    enabled: true
    criteria:
      type: And
      criteria:
        - type: Or
          criteria:
            - type: HeaderPattern
              header: "From"
              pattern: "(?i).*(paypal|amazon|microsoft|google|apple|netflix|walmart|target|chase|bank.*america|wells.*fargo).*"
            - type: SubjectPattern
              pattern: "(?i).*(paypal|amazon|microsoft|google|apple|netflix|walmart|target|chase|bank.*america|wells.*fargo).*"
        - type: Or
          criteria:
            - type: HeaderPattern
              header: "Authentication-Results"
              pattern: "dkim=fail"
            - type: HeaderPattern
              header: "Authentication-Results"
              pattern: "spf=fail"
            - type: And
              criteria:
                - type: Not
                  criteria:
                    type: HeaderPattern
                    header: "Authentication-Results"
                    pattern: "dkim=pass"
                - type: Not
                  criteria:
                    type: Or
                    criteria:
                      - type: BodyPattern
                        pattern: "(?i).*(apple.*wallet|google.*pay|samsung.*pay|paypal.*integration|amazon.*partnership).*"
                      - type: SenderPattern
                        pattern: ".*@.*(discover|chase|citi|amex|wellsfargo|bankofamerica)\\.(com|org)$"
        - type: Not
          criteria:
            type: Or
            criteria:
              - type: SenderPattern
                pattern: ".*@.*(medium|backerkit|joinhoney|williams-sonoma|lovepop|shutterfly|resmed|quora|nytimes)\\.(com|org)$"
              - type: HeaderPattern
                header: "Authentication-Results"
                pattern: "dkim=pass.*\\.(medium|backerkit|joinhoney|williams-sonoma|lovepop|shutterfly|resmed|quora)\\.(com|org)"
    score: 200
    description: "Brand impersonation with authentication failure (excluding legitimate newsletters)"

  # Known brand from suspicious domain
  - name: "Known brand from suspicious domain"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "HeaderPattern"
              header: "From"
              pattern: "(?i).*(McDonald's|Netflix|Disney|Starbucks|Walmart|Amazon|Target|Best Buy|Home Depot|Lowe's|CVS|Walgreens|Chase|Bank of America|Wells Fargo|Citi|Capital One|American Express|Discover|PayPal|Venmo|Cash App|Zelle|Apple|Microsoft|Google|Facebook|Instagram|Twitter|LinkedIn|YouTube|TikTok|Snapchat|WhatsApp|Telegram|Zoom|Skype|Slack|Teams|Dropbox|OneDrive|iCloud|Gmail|Yahoo|Outlook|Hotmail|AOL|Comcast|Verizon|AT&T|T-Mobile|Sprint|UPS|FedEx|USPS|DHL|Uber|Lyft|Airbnb|Booking|Expedia|Priceline|Hotels|Marriott|Hilton|Hyatt|IHG|Choice|Wyndham|Radisson|Accor|Four Seasons|Ritz Carlton|Sheraton|Westin|Doubletree|Hampton|Holiday Inn|Courtyard|Residence Inn|SpringHill|Fairfield|TownePlace|Aloft|Element|Moxy|AC Hotels|Autograph|Tribute|Design Hotels|Luxury Collection|St. Regis|W Hotels|Edition|Le Meridien|Renaissance|Delta|Gaylord|Omni|Loews|Kimpton|Joie de Vivre|Thompson|Tommie|Unbound|Tapestry|Curio|DoubleTree|Embassy Suites|Homewood Suites|Home2 Suites|Tru|Canopy|Signia|LXR|Conrad|Waldorf Astoria|Tempo|Graduate|Even|Avid|WoodSpring|MainStay|Candlewood|Staybridge|Extended Stay|Red Roof|Motel 6|Super 8|Days Inn|Ramada|Howard Johnson|Travelodge|Knights Inn|Econo Lodge|Quality Inn|Comfort Inn|Comfort Suites|Sleep Inn|Clarion|Cambria|Ascend|Suburban|WoodSpring|MainStay|Candlewood|Staybridge|Extended Stay|Red Roof|Motel 6|Super 8|Days Inn|Ramada|Howard Johnson|Travelodge|Knights Inn|Econo Lodge|Quality Inn|Comfort Inn|Comfort Suites|Sleep Inn|Clarion|Cambria|Ascend|Suburban).*"
            - type: "SubjectPattern"
              pattern: "(?i).*(McDonald's|Netflix|Disney|Starbucks|major.*brand|official.*notification|customer.*service|account.*verification|security.*alert).*"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "SenderPattern"
                pattern: ".*@.*(mcdonalds|netflix|disney|starbucks|walmart|amazon|target|bestbuy|homedepot|lowes|cvs|walgreens|chase|bankofamerica|wellsfargo|citi|capitalone|americanexpress|discover|paypal|venmo|apple|microsoft|google|facebook|instagram|twitter|linkedin|youtube|tiktok|snapchat|whatsapp|telegram|zoom|skype|slack|teams|dropbox|onedrive|icloud|gmail|yahoo|outlook|hotmail|aol|comcast|verizon|att|tmobile|sprint|ups|fedex|usps|dhl|uber|lyft|airbnb|booking|expedia|priceline|hotels|marriott|hilton|hyatt|ihg|choice|wyndham|radisson|accor)\\.(com|org|net)$"
              - type: "SenderPattern"
                pattern: ".*@.*(sparkpostmail|sendgrid|mailchimp|amazonses|constantcontact|mailgun)\\.(com|net)$"
              - type: "HeaderPattern"
                header: "Authentication-Results"
                pattern: "dkim=pass"
    score: 150
    description: "Known brand claims from suspicious or unrelated domains"

  # AAA Emergency Kit Scams
  - name: "AAA Emergency Kit Scams"
    enabled: true
    criteria:
      type: And
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(aaa.*emergency.*kit|triple.*a.*kit|car.*emergency.*kit|safety.*kit|survival.*kit).*"
            - type: "BodyPattern"
              pattern: "(?i).*(aaa.*member|triple.*a.*member|emergency.*roadside|car.*breakdown|roadside.*assistance).*"
            - type: "BodyPattern"
              pattern: "(?i).*(state.*farm.*kit|allstate.*kit|geico.*kit|progressive.*kit).*"
        - type: Not
          criteria:
            type: SenderPattern
            pattern: ".*@.*nytimes.*"
    score: 150
    description: "AAA and insurance company emergency kit scams"

  # Microsoft OnMicrosoft Compromise
  - name: "Microsoft OnMicrosoft Compromise"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@.*\\.onmicrosoft\\.com$"
        - type: "Or"
          criteria:
            - type: "HeaderPattern"
              header: "Authentication-Results"
              pattern: "dkim=fail"
            - type: "SubjectPattern"
              pattern: "(?i).*(taste|special|uid[0-9]+|restaurant|food|dining).*"
    score: 100
    description: "Compromised Microsoft tenant domains"

  # Healthcare and Government Impersonation
  - name: "Healthcare Government Impersonation"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(medicare|medicaid|unitedhealthcare|benefits.*center|veteran.*affairs).*"
            - type: "BodyPattern"
              pattern: "(?i).*(health.*insurance|medicare.*advantage|benefits.*enrollment|va.*benefits|health.*benefits.*center).*"
            - type: "SubjectPattern"
              pattern: "(?i).*(cvs.*order|pharmacy.*confirmation|prescription.*ready|health.*plan).*"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "SenderPattern"
                pattern: ".*@.*(cvs|unitedhealthcare|medicare|va|veterans|adapthealth|adapthealthmarketplace)\\.(com|org|gov)$"
              - type: "BodyPattern"
                pattern: "(?i).*(loyalty.*program|rewards.*program|membership.*benefits|shipping.*benefits|passport.*benefits).*"
    score: 175
    description: "Healthcare and government service impersonation"

  # Critical Brand Impersonation
  - name: "Critical Brand Impersonation"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: "(?i).*(amazon|apple|microsoft|google|facebook|paypal|aarp|walmart|target|netflix|disney|fedex|ups|visa|chase|bank).*"
        - type: "Or"
          criteria:
            - type: "HeaderPattern"
              header: "Authentication-Results"
              pattern: "dkim=fail"
            - type: "HeaderPattern"
              header: "Authentication-Results"
              pattern: "spf=fail"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "SenderPattern"
                pattern: ".*@.*(sparkpostmail|sendgrid|mailchimp|constantcontact|amazonses|mailgun|klaviyomail|campaignmonitor|aweber)\\.(com|net|org)$"
              - type: "SenderPattern"
                pattern: ".*@.*(amazon|google|microsoft|apple|netflix|walmart|target|disney|fedex|ups|visa|chase)\\.(com|org)$"
              - type: "HeaderPattern"
                header: "From"
                pattern: "(?i).*(newsletter|digest|marketing|promotional|noreply|no-reply).*"
    score: 300
    description: "Critical: Major brand + authentication failure + domain mismatch"

  # SendGrid impersonation from skytronreveal
  - name: "SendGrid impersonation from skytronreveal"
    enabled: true
    criteria:
      type: "HeaderPattern"
      header: "From"
      pattern: ".*@skytronreveal\\.com.*"
    score: 100
    description: "SendGrid brand impersonation from unrelated domain"

  # Microsoft tenant Stanley Tools impersonation
  - name: "Microsoft tenant Stanley Tools impersonation"
    enabled: true
    criteria:
      type: "HeaderPattern"
      header: "From"
      pattern: ".*@dailydials19\\.onmicrosoft\\.com.*"
    score: 100
    description: "Brand impersonation from Microsoft tenant"
  # State Farm fire kit impersonation
  - name: "State Farm Fire Kit Impersonation"
    criteria:
      type: Or
      criteria:
        - type: SubjectPattern
          pattern: "(?i).*(fire.*doesn.*t.*wait.*neither.*should.*you|state.*farm.*fire.*emergency.*kit|fire.*kit.*brand.*impersonation).*"
        - type: BodyPattern
          pattern: "(?i).*(fire.*doesn.*t.*wait.*neither.*should.*you|state.*farm.*fire.*emergency.*kit|fire.*kit.*brand.*impersonation).*"
    score: 280
  # WeTransfer brand impersonation
  - name: "WeTransfer Brand Impersonation"
    criteria:
      type: Or
      criteria:
        - type: SubjectPattern
          pattern: "(?i).*(transfer.*you.*received.*expired.*can.*still.*recover|wetransfer.*brand.*impersonation|fake.*wetransfer).*"
        - type: BodyPattern
          pattern: "(?i).*(transfer.*you.*received.*expired.*can.*still.*recover|wetransfer.*brand.*impersonation|fake.*wetransfer).*"
    score: 300
  # YETI brand impersonation Google Workspace
  - name: "YETI Brand Impersonation Google Workspace"
    criteria:
      type: Or
      criteria:
        - type: SubjectPattern
          pattern: "(?i).*(yeti.*outdoor.*bundle.*final.*shipping.*stage|yeti.*brand.*impersonation|fake.*yeti.*shipping).*"
        - type: BodyPattern
          pattern: "(?i).*(yeti.*outdoor.*bundle.*final.*shipping.*stage|yeti.*brand.*impersonation|fake.*yeti.*shipping).*"
    score: 290
  # USA Today brand impersonation
  - name: "USA Today Brand Impersonation"
    criteria:
      type: Or
      criteria:
        - type: SubjectPattern
          pattern: "(?i).*(usa.*today.*automotive.*aftermarket.*special.*edition|usa.*today.*brand.*impersonation|fake.*usa.*today).*"
        - type: BodyPattern
          pattern: "(?i).*(usa.*today.*automotive.*aftermarket.*special.*edition|usa.*today.*brand.*impersonation|fake.*usa.*today).*"
    score: 280

  # Unrelated Domain Brand Impersonation
  - name: "Unrelated Domain Brand Impersonation"
    enabled: true
    criteria:
      type: Or
      criteria:
        - type: And
          criteria:
            - type: HeaderPattern
              header: "From"
              pattern: "(?i).*wellaheat.*"
            - type: SenderPattern
              pattern: ".*@sydneyentertainmentcomplex\\.com$"
        - type: SenderPattern
          pattern: ".*@sydneyentertainmentcomplex\\.com$"
    score: 250
    description: "Suspicious domain used for multiple unrelated spam campaigns"

  # Suspicious Shop Domain Health Spam
  - name: "Suspicious Shop Domain Health Spam"
    enabled: true
    criteria:
      type: And
      criteria:
        - type: SenderPattern
          pattern: ".*@.*\\.shop$"
        - type: Or
          criteria:
            - type: SubjectPattern
              pattern: "(?i).*(japanese.*candy|joint.*replacement|surgery|supplement|miracle|health.*cure|pain.*relief).*"
            - type: BodyPattern
              pattern: "(?i).*(japanese.*candy|joint.*replacement|surgery|supplement|miracle|health.*cure|pain.*relief).*"
    score: 75
    description: "Health supplement spam from suspicious .shop domains"
