# FOFF Milter Phishing-First Detection Configuration
# Prioritizes fraud detection over spam filtering

[detection_phases]
# Processing order - phishing detection runs first
enabled_phases = [
    "normalization",
    "infrastructure_analysis", 
    "phishing_detection",
    "content_analysis",
    "spam_detection"
]

[phishing_thresholds]
# Lower thresholds for phishing detection (more sensitive)
critical_reject = 300      # Immediate rejection
high_confidence = 200      # Tag as phishing
moderate_confidence = 100  # Flag for review
low_confidence = 50        # Monitor

# Separate from spam thresholds
spam_threshold = 120       # Current spam detection level

[threat_classification]
# Phishing categories in priority order
critical_threats = [
    "credential_harvesting",
    "financial_fraud", 
    "business_email_compromise",
    "brand_impersonation"
]

high_priority = [
    "domain_spoofing",
    "authentication_bypass",
    "social_engineering",
    "malware_delivery"
]

moderate_priority = [
    "suspicious_links",
    "encoding_evasion",
    "sender_spoofing",
    "content_manipulation"
]

[confidence_multipliers]
# Boost confidence when multiple indicators present
authentication_failure = 1.5
domain_mismatch = 1.3
brand_claim = 1.2
urgent_language = 1.1

# Reduce confidence for legitimate senders
verified_esp = 0.5
government_domain = 0.3
established_brand = 0.7

[phishing_patterns]
# Core phishing detection patterns
hr_document_sharing = {
    pattern = "(?i).*(hr.*shared|hr.*document|salary.*review|incentive.*overview)",
    score = 200,
    category = "business_email_compromise"
}

organization_impersonation = {
    pattern = "(?i).*\\b[a-z]+domain\\.com\\s+(hr|it|admin|support|team).*",
    score = 150, 
    category = "brand_impersonation"
}

credential_harvesting = {
    pattern = "(?i).*(verify.*account|update.*password|confirm.*identity|security.*alert)",
    score = 200,
    category = "credential_harvesting"
}

financial_urgency = {
    pattern = "(?i).*(payment.*failed|account.*suspended|billing.*issue|invoice.*overdue)",
    score = 175,
    category = "financial_fraud"
}

[bypass_prevention]
# Prevent common evasion techniques
encoding_layers_max = 3    # Flag emails with 3+ encoding layers
unicode_obfuscation = true # Detect homoglyph attacks
zero_width_chars = true    # Remove zero-width characters
suspicious_mime = true     # Flag unusual MIME structures
