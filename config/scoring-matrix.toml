# FOFF Milter Scoring Matrix
# Replaces complex YAML logic with simple lookup tables

[threat_combinations]
# High-confidence phishing combinations
brand_auth_domain = 300    # Brand claim + Auth failure + Domain mismatch
brand_auth = 200          # Brand claim + Auth failure  
brand_domain = 150        # Brand claim + Domain mismatch
auth_domain = 125         # Auth failure + Domain mismatch

# Business Email Compromise patterns
hr_document_auth = 250    # HR document + Auth failure
payroll_domain = 225      # Payroll content + Domain mismatch
executive_impersonation = 275  # Executive name + Wrong domain

# Financial fraud combinations  
payment_urgent_auth = 250 # Payment + Urgency + Auth failure
invoice_domain = 200      # Invoice + Domain mismatch
refund_credential = 225   # Refund + Credential request

[sender_reputation]
# ESP and domain reputation modifiers
verified_esp = -100       # Legitimate ESP (negative score)
government_domain = -200  # .gov/.mil/.edu domains
established_brand = -150  # Known legitimate brand
newsletter_platform = -75 # Newsletter service

suspicious_tld = 75       # Suspicious TLD (.tk, .ml, etc)
new_domain = 50          # Domain registered < 30 days
no_reputation = 25       # Unknown sender

[content_scoring]
# Content-based threat indicators
credential_harvest = 200  # Password/account verification
financial_urgency = 175   # Payment/billing urgency
malware_attachment = 250  # Suspicious attachments
phishing_links = 150     # Suspicious URLs

# Legitimate content indicators
unsubscribe_present = -25 # Proper unsubscribe
business_hours = -15     # Sent during business hours
professional_format = -20 # Professional email format

[authentication_matrix]
# Authentication-based scoring
dkim_fail_brand = 150    # DKIM fail + Brand claim
spf_fail_brand = 125     # SPF fail + Brand claim  
dmarc_fail = 100         # DMARC failure
no_auth = 50            # No authentication

dkim_pass = -25         # Valid DKIM
spf_pass = -15          # Valid SPF
dmarc_pass = -35        # Valid DMARC

[evasion_detection]
# Encoding and obfuscation penalties
multiple_encoding = 75   # 3+ encoding layers
unicode_obfuscation = 100 # Homoglyph attacks
zero_width_chars = 50    # Zero-width characters
suspicious_mime = 60     # Unusual MIME structure

# Legitimate encoding (newsletters, etc)
standard_html = -10      # Standard HTML encoding
marketing_format = -15   # Legitimate marketing format
