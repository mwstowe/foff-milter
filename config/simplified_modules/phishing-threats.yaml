name: "Phishing Threats"
enabled: true
rules:
  # HR/BEC Document Sharing (+200 points)
  - name: "HR Document Sharing Phishing"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(hr.*shared|hr.*document|salary.*review|incentive.*overview|payroll.*update|employee.*handbook).*"
            - type: "CombinedTextPattern"
              pattern: "(?i).*(hr.*department.*shared|view.*salary.*document|access.*payroll.*information|employee.*benefits.*update).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*(company\\.com|organization\\.org|legitimate\\.edu)$"
    score: 200
    description: "Business Email Compromise targeting HR/payroll documents"

  # Critical Phishing Patterns (+300 points)
  - name: "Critical Phishing Patterns"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(urgent.*action.*required|account.*will.*be.*closed|verify.*immediately|suspended.*account|click.*here.*now).*"
        - type: "CombinedTextPattern"
          pattern: "(?i).*(verify.*your.*account.*now|click.*here.*to.*verify|account.*has.*been.*suspended|immediate.*action.*required).*"
        - type: "CombinedTextPattern"
          pattern: "(?i).*(congratulations.*you.*have.*won|claim.*your.*prize.*now|limited.*time.*offer.*expires|act.*now.*or.*lose).*"
    score: 300
    description: "High-urgency phishing language patterns"

  # Financial Phishing (+250 points)
  - name: "Financial Phishing"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(payment.*failed|card.*declined|account.*overdrawn|suspicious.*activity|fraud.*alert).*"
        - type: "CombinedTextPattern"
          pattern: "(?i).*(update.*payment.*method|verify.*card.*information|confirm.*bank.*details|resolve.*payment.*issue).*"
        - type: "CombinedTextPattern"
          pattern: "(?i).*(refund.*pending|tax.*refund.*available|stimulus.*payment|government.*benefit).*"
    score: 250
    description: "Financial fraud and payment scam detection"

  # Security Alert Phishing (+200 points)
  - name: "Security Alert Phishing"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(security.*alert|suspicious.*login|unauthorized.*access|breach.*detected|virus.*found).*"
        - type: "CombinedTextPattern"
          pattern: "(?i).*(your.*computer.*infected|malware.*detected|security.*scan.*required|update.*antivirus).*"
        - type: "CombinedTextPattern"
          pattern: "(?i).*(microsoft.*security|windows.*defender|apple.*security|google.*security).*"
    score: 200
    description: "Fake security alerts and tech support scams"

  # Invoice/Receipt Phishing (+150 points)
  - name: "Invoice Receipt Phishing"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(invoice.*attached|receipt.*confirmation|payment.*due|billing.*statement).*"
            - type: "CombinedTextPattern"
              pattern: "(?i).*(view.*invoice|download.*receipt|payment.*overdue|billing.*inquiry).*"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "SenderPattern"
                pattern: ".*@.*(paypal|stripe|square|quickbooks|freshbooks)\\.(com|org)$"
              - type: "HeaderPattern"
                header: "Authentication-Results"
                pattern: "dkim=pass.*spf=pass"
    score: 150
    description: "Fake invoice and receipt phishing attempts"

  # Cloud Storage Phishing (+100 points)
  - name: "Cloud Storage Phishing"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(document.*shared|file.*shared|folder.*shared|shared.*with.*you).*"
        - type: "CombinedTextPattern"
          pattern: "(?i).*(view.*document|access.*file|download.*shared|dropbox.*shared|google.*drive.*shared).*"
        - type: "CombinedTextPattern"
          pattern: "(?i).*(onedrive.*shared|icloud.*shared|box\\.com.*shared|shared.*folder).*"
    score: 100
    description: "Fake cloud storage sharing notifications"

  # DocuSign Phishing (+175 points)
  - name: "DocuSign Phishing"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(docusign|document.*signature|sign.*document|electronic.*signature).*"
            - type: "CombinedTextPattern"
              pattern: "(?i).*(please.*sign|review.*and.*sign|signature.*required|document.*awaiting).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*docusign\\.(com|net)$"
    score: 175
    description: "Fake DocuSign and document signing phishing"

  # WeTransfer Phishing (+125 points)
  - name: "WeTransfer Phishing"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(wetransfer|file.*transfer|download.*files|transfer.*expires).*"
            - type: "CombinedTextPattern"
              pattern: "(?i).*(files.*ready.*download|transfer.*link|download.*before.*expires).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*wetransfer\\.(com|net)$"
    score: 125
    description: "Fake WeTransfer file sharing phishing"

  # Domain Spoofing and System Impersonation (+200 points)
  - name: "Domain Spoofing System Impersonation"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(removal.*request.*server|server.*accepted|domain.*removal|unsubscribe.*request).*"
        - type: "SubjectPattern"
          pattern: "(?i).*(mailer.*daemon|delivery.*failure|bounce.*message|system.*administrator).*"
        - type: "CombinedTextPattern"
          pattern: "(?i).*(server.*maintenance|system.*notification|automated.*message|no.*reply).*"
        - type: "SubjectPattern"
          pattern: "(?i).*(account.*suspension|account.*suspended|domain.*impersonation|test.*subject).*"
        - type: "SubjectPattern"
          pattern: "(?i).*(nota.*fiscal|invoice.*eletronica|black.*friday.*sale|happening.*now).*"
    score: 200
    description: "Domain spoofing and system service impersonation"

  # Cloud Storage Phishing
  - name: "Cloud Storage Phishing"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(dropbox.*shared|google.*drive.*shared|onedrive.*shared|file.*shared.*you|document.*shared|shared.*folder|download.*file|view.*document).*"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "SenderPattern"
                pattern: ".*@.*(charmtracker|medical|healthcare|clinic|hospital|ehr)\\.(com|net|org)$"
              - type: "HeaderPattern"
                header: "From"
                pattern: "(?i).*(AceMed|Medical|Healthcare|Clinic|Hospital|EHR|Patient Portal).*"
    score: 35
    description: "Fake cloud storage sharing notifications (excluding legitimate medical services)"

  # Payment Service Abuse
  - name: "Payment Service Abuse"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(paypal.*payment|stripe.*payment|square.*payment|payment.*received|money.*sent|invoice.*paid|transaction.*complete|refund.*processed).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*(paypal|stripe|square|quickbooks|intuit)\\.(com|net)$"
    score: 75
    description: "Fake payment service notifications"

  # From Header Domain Impersonation
  - name: "From Header Domain Impersonation"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "HeaderPattern"
          header: "From"
          pattern: "\"[^\"@]+\\.(com|org|net|gov|edu|mil)\"\\s*<[^@]+@[^>]+>"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "HeaderPattern"
                header: "From"
                pattern: "\"[^\"@]+\"\\s*<[^@]+@.*walgreens\\.(com|net)>"
              - type: "HeaderPattern"
                header: "From"
                pattern: "\"[^\"@]+\"\\s*<[^@]+@.*doordash\\.(com|net)>"
              - type: "HeaderPattern"
                header: "From"
                pattern: "\"[^\"@]+\"\\s*<[^@]+@.*amazon\\.(com|net)>"
              - type: "HeaderPattern"
                header: "From"
                pattern: "\"[^\"@]+\"\\s*<[^@]+@.*microsoft\\.(com|net)>"
        - type: "Or"
          criteria:
            - type: "BodyPattern"
              pattern: "(?i)(password|account|login|verify|confirm|suspend|expir|action.*required)"
            - type: "SubjectPattern"
              pattern: "(?i)(action.*required|urgent|expir|suspend|verify|password)"
    score: 90
    description: "From header displays domain name in quotes with completely different sender domain"

  # Password Expiration Phishing
  - name: "Password Expiration Phishing"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(password.*expir|password.*reset|account.*expir|login.*expir|access.*expir).*"
            - type: "BodyPattern"
              pattern: "(?i).*(password.*expir|password.*reset|account.*expir|login.*expir|access.*expir).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*(microsoft|google|apple|amazon|paypal|adobe|salesforce|zoom|slack|dropbox)\\.(com|org)$"
    score: 80
    description: "Password expiration phishing attempts"
  # CVS/Medicare phishing
  - name: "CVS Medicare Phishing"
    criteria:
      type: Or
      criteria:
        - type: SubjectPattern
          pattern: "(?i).*(cvs.*medicare|medicare.*cvs|pharmacy.*benefit).*"
        - type: BodyPattern
          pattern: "(?i).*(cvs.*medicare|medicare.*cvs|pharmacy.*benefit).*"
    score: 300

  # Fake invoice patterns
  - name: "Fake Invoice Scam"
    criteria:
      type: Or
      criteria:
        - type: SubjectPattern
          pattern: "(?i).*(fake.*invoice|norton.*invoice|order.*receipt|payment.*receipt).*"
        - type: BodyPattern
          pattern: "(?i).*(fake.*invoice|norton.*invoice|order.*receipt|payment.*receipt).*"
    score: 280

  # Brand impersonation (Google Workspace)
  - name: "Google Workspace Impersonation"
    criteria:
      type: Or
      criteria:
        - type: SubjectPattern
          pattern: "(?i).*(google.*workspace|workspace.*google|yeti.*brand).*"
        - type: BodyPattern
          pattern: "(?i).*(google.*workspace|workspace.*google|yeti.*brand).*"
    score: 250

  # Investment scams
  - name: "Investment Scam Patterns"
    criteria:
      type: Or
      criteria:
        - type: SubjectPattern
          pattern: "(?i).*(fam.*investment|investment.*opportunity|guaranteed.*returns).*"
        - type: BodyPattern
          pattern: "(?i).*(fam.*investment|investment.*opportunity|guaranteed.*returns).*"
    score: 300

  # Romance scams
  - name: "Romance Scam Detection"
    criteria:
      type: Or
      criteria:
        - type: SubjectPattern
          pattern: "(?i).*(ukrainian.*romance|romance.*scam|lonely.*heart).*"
        - type: BodyPattern
          pattern: "(?i).*(ukrainian.*romance|romance.*scam|lonely.*heart).*"
    score: 350

  # International phishing
  - name: "International Phishing"
    criteria:
      type: Or
      criteria:
        - type: SubjectPattern
          pattern: "(?i).*(portuguese.*signature|sbi.*phishing|international.*bank).*"
        - type: BodyPattern
          pattern: "(?i).*(portuguese.*signature|sbi.*phishing|international.*bank).*"
    score: 280
