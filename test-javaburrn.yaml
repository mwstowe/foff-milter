socket_path: "/var/run/foff-milter.sock"
default_action:
  type: "Accept"

rules:
  # Test the exact domain from the email (fixed pattern)
  - name: "Tag javaburrn.rest (misspelled)"
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*javaburrn\\.rest$"
    action:
      type: "TagAsSpam"
      header_name: "X-Spam-Flag"
      header_value: "YES"

  # Test the original pattern (fixed)
  - name: "Tag javaburn.rest (correct spelling)"
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*javaburn\\.rest$"
    action:
      type: "TagAsSpam"
      header_name: "X-Spam-Original"
      header_value: "YES"

  # Test a broader pattern that catches both
  - name: "Tag javabu*rn.rest (flexible)"
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*javabu.*rn\\.rest$"
    action:
      type: "TagAsSpam"
      header_name: "X-Spam-Flexible"
      header_value: "YES"
