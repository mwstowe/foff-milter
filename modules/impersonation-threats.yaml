name: "Impersonation Threats"
enabled: true
rules:
  # Document signing services
  - name: "Document signing services impersonation"
    criteria:
      type: "BrandImpersonation"
      brand_name: "document_signing"
      subject_patterns:
        - "(?i).*(docusign|document.*ready|signature.*required|sign.*document|review.*document|complete.*electronically).*"
      sender_patterns:
        - "(?i).*docusign.*"
      legitimate_domains:
        - "docusign.com"
        - "docusign.net"
    score: 60
    description: "DocuSign and document signing service impersonation"

  # Payment services
  - name: "Payment services impersonation"
    criteria:
      type: "BrandImpersonation"
      brand_name: "payment_services"
      subject_patterns:
        - "(?i).*(paypal|payment.*pending|account.*suspended|verify.*account|activation.*order|order.*activated|order.*for.*\\$).*"
      sender_patterns:
        - "(?i).*paypal.*"
      legitimate_domains:
        - "paypal.com"
        - "paypal.co.uk"
    score: 80
    description: "PayPal and payment service impersonation"

  # Healthcare and consumer brands
  - name: "Healthcare and consumer brands impersonation"
    criteria:
      type: "BrandImpersonation"
      brand_name: "healthcare_consumer"
      subject_patterns:
        - "(?i).*(cvs|walgreens|rite.*aid|pharmacy|prescription|medication|health.*insurance).*"
      sender_patterns:
        - "(?i).*(cvs|walgreens|rite.*aid).*"
      legitimate_domains:
        - "cvs.com"
        - "walgreens.com"
        - "riteaid.com"
    score: 60
    description: "Healthcare and consumer brand impersonation"

  # Mailer daemon spoofing
  - name: "Mailer daemon spoofing"
    criteria:
      type: "SenderPattern"
      pattern: ".*MAILER-DAEMON.*"
    score: 80
    description: "MAILER-DAEMON spoofing detection"

  # Fake payment confirmations
  - name: "Fake payment confirmation and transaction scams"
    criteria:
      type: "SubjectPattern"
      pattern: "(?i).*(payment.*confirmation|transaction.*complete|order.*confirmation|receipt.*attached|invoice.*\\#\\d+|payment.*received|charge.*processed).*"
    score: 90
    description: "Fake payment confirmation and transaction scams"

  # Romance and dating scams
  - name: "Romance and dating scams"
    criteria:
      type: "SubjectPattern"
      pattern: "(?i).*(lonely.*heart|seeking.*love|romantic.*connection|dating.*site|meet.*singles|find.*love|soulmate|relationship|marriage.*proposal).*"
    score: 80
    description: "Romance and dating scam detection"

  # Social engineering and urgency
  - name: "Social engineering and urgency scams"
    criteria:
      type: "SubjectPattern"
      pattern: "(?i).*(urgent.*action.*required|immediate.*response|account.*will.*be.*closed|verify.*immediately|suspended.*account|security.*alert|unauthorized.*access).*"
    score: 100
    description: "Social engineering and urgency-based scams"

  # Fake delivery notifications
  - name: "Fake delivery and shipping notifications"
    criteria:
      type: "And"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(delivery.*failed|package.*undelivered|shipping.*notification|ups.*delivery|fedex.*delivery|usps.*delivery|dhl.*delivery).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*(ups|fedex|usps|dhl)\\.com.*"
    score: 100
    description: "Fake delivery and shipping notifications from non-legitimate domains"

  # Telecom brand impersonation
  - name: "Telecom brand impersonation"
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: "(?i).*(t-mobile|tmobile|verizon|att|at&t|sprint|boost|metro).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*(t-mobile|tmobile|verizon|att|sprint|boost|metro)\\.com.*"
    score: 95
    description: "Telecom brand impersonation from non-legitimate domains"

  # Retail brand impersonation
  - name: "Retail brand impersonation"
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: "(?i).*(sams.*club|walmart|costco|target|bestbuy|homedepot|lowes).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*(samsclub|walmart|costco|target|bestbuy|homedepot|lowes)\\.com.*"
    score: 90
    description: "Retail brand impersonation from non-legitimate domains"
