name: "Brand Impersonation Protection"
enabled: true
rules:
  - name: "DocuSign phishing with suspicious domains"
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(docusign|document.*ready|signature.*required|sign.*document|review.*document|complete.*electronically).*"
            - type: "SenderPattern"
              pattern: "(?i).*docusign.*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@(docusign\\.com|docusign\\.net)$"
    score: 50
    description: "DocuSign brand impersonation from non-DocuSign domains"

  - name: "PayPal phishing from compromised educational domains"
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(paypal|payment.*pending|account.*suspended|verify.*account|activation.*order|order.*activated|order.*for.*\\$).*"
            - type: "SenderPattern"
              pattern: "(?i).*paypal.*"
        - type: "SenderPattern"
          pattern: ".*@.*\\.(edu|ac\\.|k12\\.|edu\\.).*"
    score: 50
    description: "PayPal phishing from compromised educational domains"

  - name: "AAA brand impersonation"
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(aaa.*car.*kit|free.*car.*emergency|aaa.*emergency|free.*safety.*kit).*"
            - type: "SenderPattern"
              pattern: "(?i).*aaa.*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@(aaa\\.com|csaa\\.com)$"
    score: 30
    description: "AAA brand impersonation from non-AAA domains"

  - name: "AAA brand impersonation with auth failure"
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(aaa.*car.*kit|free.*car.*emergency|aaa.*emergency|free.*safety.*kit).*"
            - type: "SenderPattern"
              pattern: "(?i).*aaa.*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@(aaa\\.com|csaa\\.com)$"
        - type: "HeaderPattern"
          header: "Authentication-Results"
          pattern: "dkim=fail"
    score: 60
    description: "AAA brand impersonation with failed authentication"

  - name: "Return-Path and From domain mismatch"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "PhishingDomainMismatch"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "SenderPattern"
                pattern: ".*@.*\\.mailgun\\.org$"
              - type: "SenderPattern"
                pattern: ".*@.*\\.sendgrid\\.net$"
              - type: "SenderPattern"
                pattern: ".*@.*\\.amazonses\\.com$"
              - type: "SenderPattern"
                pattern: ".*@.*\\.mailjet\\.com$"
              - type: "SenderPattern"
                pattern: ".*@.*\\.mandrill\\.com$"
              - type: "SenderPattern"
                pattern: ".*@.*\\.sparkpostmail\\.com$"
              - type: "SenderPattern"
                pattern: ".*@bounce\\..*"
              - type: "SenderPattern"
                pattern: ".*@.*\\.salesforce\\.com$"
              - type: "And"
                criteria:
                  - type: "HeaderPattern"
                    header: "List-Unsubscribe"
                    pattern: ".*"
                  - type: "HeaderPattern"
                    header: "DKIM-Signature"
                    pattern: ".*"
                  - type: "SenderPattern"
                    pattern: ".*@.*\\.(com|net|org)$"
              - type: "SenderPattern"
                pattern: ".*@.*\\.benchmarkemail\\.com$"
              - type: "And"
                criteria:
                  - type: "HeaderPattern"
                    header: "From"
                    pattern: ".*@.*discover\\.com.*"
                  - type: "HeaderPattern"
                    header: "DKIM-Signature"
                    pattern: ".*d=discover\\.com.*"
                  - type: "HeaderPattern"
                    header: "Authentication-Results"
                    pattern: "dkim=pass"
              - type: "HeaderPattern"
                header: "List-ID"
                pattern: ".*"
              - type: "HeaderPattern"
                header: "X-Google-Group-Id"
                pattern: ".*"
              - type: "SenderPattern"
                pattern: ".*via.*"
    score: 25
    description: "Suspicious domain mismatch between Return-Path and From headers"

  - name: "WeTransfer brand impersonation"
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(wetransfer|file.*transfer|download.*files|shared.*files).*"
            - type: "SenderPattern"
              pattern: "(?i).*wetransfer.*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@(wetransfer\\.com|we\\.tl)$"
    score: 50
    description: "WeTransfer brand impersonation from non-WeTransfer domains"

  - name: "SBI Securities phishing"
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(SBI証券|配当金|お取引履歴).*"
            - type: "SenderPattern"
              pattern: "(?i).*SBI.*"
            - type: "BodyPattern"
              pattern: "(?i).*(SBI証券|配当金|お取引履歴|金融商品取引業者).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@(sbisec\\.co\\.jp|sbigroup\\.co\\.jp)$"
    score: 60
    description: "Phishing emails impersonating SBI Securities from non-SBI domains"

  - name: "UnitedHealthcare brand impersonation"
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(unitedhealthcare|united\\s+healthcare|uhc.*benefits).*"
            - type: "BodyPattern"
              pattern: "(?i).*(unitedhealthcare|united\\s+healthcare|uhc\\s|benefits.*center|healthcare.*experiences).*"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "SenderPattern"
                pattern: ".*@.*(unitedhealthcare\\.com|uhc\\.com|optum\\.com|myuhc\\.com)$"
              - type: "BodyPattern"
                pattern: "(?i).*(united\\s+states|u\\.s\\.|usps|postal\\s+service).*"
              - type: "SenderPattern"
                pattern: ".*@.*(adapthealthmarketplace\\.com|reacthealth\\.com)$"
    score: 60
    description: "UnitedHealthcare brand impersonation from non-UHC domains"
