name: "Brand Impersonation Protection"
enabled: true
rules:
  - name: "Document signing services impersonation"
    criteria:
      type: "BrandImpersonation"
      brand_name: "document_signing"
      subject_patterns:
        - "(?i).*(docusign|document.*ready|signature.*required|sign.*document|review.*document|complete.*electronically).*"
      sender_patterns:
        - "(?i).*docusign.*"
      legitimate_domains:
        - "docusign.com"
        - "docusign.net"
    score: 50
    description: "DocuSign and document signing service impersonation"

  - name: "Payment services impersonation"
    criteria:
      type: "BrandImpersonation"
      brand_name: "payment_services"
      subject_patterns:
        - "(?i).*(paypal|payment.*pending|account.*suspended|verify.*account|activation.*order|order.*activated|order.*for.*\\$).*"
      sender_patterns:
        - "(?i).*paypal.*"
      legitimate_domains:
        - "paypal.com"
        - "paypal.co.uk"
    score: 60
    description: "PayPal and payment service impersonation"

  - name: "Tech support services impersonation"
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(geek.*squad|protection.*plan.*renewal|invoice.*id.*fw|verifying.*order.*\\$[0-9]+).*"
            - type: "BodyPattern"
              pattern: "(?i).*(geek.*squad.*billing|protection.*plan.*renewed|auto.*debit.*renewal|not.*authorized.*contact|billing.*department.*immediately|cancel.*subscription.*24.*hours).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*(bestbuy|geeksquad|asus|legitimate-tech)\\.com$"
    score: 65
    description: "Geek Squad and tech support billing scam impersonation from non-legitimate domains"

  - name: "Financial services impersonation"
    criteria:
      type: "BrandImpersonation"
      brand_name: "financial_services"
      subject_patterns:
        - "(?i).*(schwab.*alert|charles.*schwab|schwab.*security|schwab.*account).*"
        - "(?i).*(SBI証券|配当金|お取引履歴).*"
      sender_patterns:
        - "(?i).*schwab.*"
        - "(?i).*SBI.*"
      body_patterns:
        - "(?i).*(SBI証券|配当金|お取引履歴).*"
      legitimate_domains:
        - "schwab.com"
        - "sbisec.co.jp"
    score: 65
    description: "Financial services and securities impersonation"

  - name: "Automotive services impersonation"
    criteria:
      type: "BrandImpersonation"
      brand_name: "automotive_services"
      subject_patterns:
        - "(?i).*(aaa.*car.*kit|free.*car.*emergency|aaa.*emergency|free.*safety.*kit|aaa.*roadside|aaa.*membership|aaa.*assistance|aaa.*covered).*"
        - "(?i).*(car.*upgrade.*ready|auto.*gift.*o'reilly|o'reilly.*auto.*parts).*"
      sender_patterns:
        - "(?i).*(\\bAAA\\b|AAA.*auto|AAA.*roadside|AAA.*membership).*"
        - "(?i).*o'reilly.*"
      legitimate_domains:
        - "aaa.com"
        - "csaa.com"
        - "oreillyauto.com"
        - "netatmo.com"
    score: 55
    description: "AAA and automotive services impersonation"

  - name: "Technology and hosting services impersonation"
    criteria:
      type: "BrandImpersonation"
      brand_name: "technology_services"
      subject_patterns:
        - "(?i).*(godaddy.*payment|godaddy.*update|godaddy.*action.*needed|godaddy.*billing).*"
        - "(?i).*(wetransfer|file.*transfer|download.*files|shared.*files).*"
        - "(?i).*(document.*approval|shared.*file|secure.*file|new.*document|file.*shared|document.*review|shared.*document).*"
      sender_patterns:
        - "(?i).*godaddy.*"
        - "(?i).*wetransfer.*"
      body_patterns:
        - "(?i).*(sharefile|shared.*file|secure.*file|document.*approval|review.*approval|authorised.*colleagues|visible.*only.*you).*"
      legitimate_domains:
        - "godaddy.com"
        - "secureserver.net"
        - "wetransfer.com"
        - "sharefile.com"
    score: 60
    description: "Technology and hosting services impersonation"

  - name: "Healthcare and consumer brands impersonation"
    criteria:
      type: "BrandImpersonation"
      brand_name: "healthcare_consumer"
      subject_patterns:
        - "(?i).*(oral.*b.*bundle|free.*oral.*b|oral.*b.*premium|oral.*b.*toothbrush).*"
        - "(?i).*(unitedhealthcare|united\\s+healthcare|uhc.*benefits).*"
      sender_patterns:
        - "(?i).*oral.*b.*"
      body_patterns:
        - "(?i).*(unitedhealthcare|united\\s+healthcare|uhc\\s|benefits.*center|healthcare.*experiences).*"
      legitimate_domains:
        - "oralb.com"
        - "pg.com"
        - "unitedhealthcare.com"
        - "uhc.com"
    score: 50
    description: "Healthcare and consumer brand impersonation"

  - name: "Authentication failure brand impersonation"
    criteria:
      type: "BrandImpersonation"
      brand_name: "auth_failure_brands"
      subject_patterns:
        - "(?i).*(aaa.*car.*kit|free.*car.*emergency|aaa.*emergency|free.*safety.*kit|aaa.*roadside|aaa.*assistance|aaa.*covered).*"
      sender_patterns:
        - "(?i).*(\\bAAA\\b|AAA.*auto|AAA.*roadside|AAA.*membership).*"
      legitimate_domains:
        - "aaa.com"
        - "csaa.com"
      require_auth_failure: true
    score: 75
    description: "Brand impersonation with authentication failure"

  - name: "Yeti brand impersonation from compromised accounts"
    enabled: true
    score: 75
    criteria:
      type: "BrandImpersonation"
      brand_name: "yeti"
      subject_patterns:
        - "(?i)yeti outdoor bundle"
        - "(?i)yeti rambler"
        - "(?i)yeti cooler"
      body_patterns:
        - "(?i)yeti outdoor bundle"
        - "(?i)yeti rambler tumbler"
        - "(?i)insulated cooler bag"
      sender_patterns:
        - "(?i)tractor supply"
      legitimate_domains:
        - "yeti.com"
        - "tractorsupply.com"
