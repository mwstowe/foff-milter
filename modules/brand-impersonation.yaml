name: "Brand Impersonation Protection"
enabled: true
rules:
  - name: "DocuSign phishing with suspicious domains"
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(docusign|document.*ready|signature.*required|sign.*document|review.*document|complete.*electronically).*"
            - type: "SenderPattern"
              pattern: "(?i).*docusign.*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@(docusign\\.com|docusign\\.net)$"
    action:
      type: "TagAsSpam"
      header_name: "X-Spam-Flag"
      header_value: "YES"
  - name: "PayPal phishing from compromised educational domains"
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(paypal|payment.*pending|account.*suspended|verify.*account|activation.*order).*"
            - type: "SenderPattern"
              pattern: "(?i).*paypal.*"
        - type: "SenderPattern"
          pattern: ".*@.*\\.(edu|ac\\.|k12\\.).*"
    action:
      type: "TagAsSpam"
      header_name: "X-Spam-Flag"
      header_value: "YES"
  - name: "AAA brand impersonation"
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(aaa.*car.*kit|free.*car.*emergency|aaa.*emergency|free.*safety.*kit).*"
            - type: "SenderPattern"
              pattern: "(?i).*aaa.*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@(aaa\\.com|csaa\\.com)$"
    score: 30
    action:
      type: "TagAsSpam"
      header_name: "X-Spam-Flag"
      header_value: "YES"
    description: "AAA brand impersonation from non-AAA domains"

  - name: "AAA brand impersonation with auth failure"
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(aaa.*car.*kit|free.*car.*emergency|aaa.*emergency|free.*safety.*kit).*"
            - type: "SenderPattern"
              pattern: "(?i).*aaa.*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@(aaa\\.com|csaa\\.com)$"
        - type: "HeaderPattern"
          header: "Authentication-Results"
          pattern: "dkim=fail"
    score: 60
    action:
      type: "Reject"
      message: "Brand impersonation with authentication failure"
    description: "AAA brand impersonation with failed authentication"
  - name: "Return-Path and From domain mismatch"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "PhishingDomainMismatch"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "HeaderPattern"
                header: "List-ID"
                pattern: ".*"
              - type: "HeaderPattern"
                header: "X-Google-Group-Id"
                pattern: ".*"
              - type: "HeaderPattern"
                header: "return-path"
                pattern: ".*\\+.*@.*"
              - type: "HeaderPattern"
                header: "return-path"
                pattern: "bounce.*@.*"
              - type: "HeaderPattern"
                header: "return-path"
                pattern: ".*noreply.*@.*"
              - type: "SenderPattern"
                pattern: ".*@.*\\.bmsend\\.com$"
              - type: "SenderPattern"
                pattern: ".*@.*\\.benchmarkemail\\.com$"
    score: 25
    action:
      type: "TagAsSpam"
      header_name: "X-FOFF-Domain-Mismatch"
      header_value: "Return-Path and From domain mismatch"
    description: "Detects when Return-Path and From headers use different domains (excludes mailing lists)"

  - name: "WeTransfer brand impersonation"
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(wetransfer|transfer.*expired|file.*expired|recover.*transfer).*"
            - type: "SenderPattern"
              pattern: "(?i).*wetransfer.*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@(wetransfer\\.com|we\\.tl)$"
    action:
      type: "TagAsSpam"
      header_name: "X-Spam-Flag"
      header_value: "YES"
