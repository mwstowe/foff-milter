name: "Performance"
enabled: true
rules:
  - name: "Trusted Domain Fast Path"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: ".*@.*(amazon\\.com|microsoft\\.com|apple\\.com|google\\.com|paypal\\.com|ebay\\.com|linkedin\\.com|twitter\\.com|facebook\\.com)$"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "AttachmentOnlyEmail"
              - type: "SubjectPattern"
                pattern: "(?i).*(invoice|billing|urgent|verify|suspend|click|winner|congratulations).*"
    score: -30
    description: "Fast path for trusted corporate domains without suspicious patterns"

  - name: "Obvious Spam Early Rejection"
    enabled: true
    criteria:
      type: "SubjectPattern"
      pattern: "(?i).*(viagra|cialis|lottery.*winner|nigerian.*prince|inheritance.*fund|click.*here.*now|act.*now|limited.*time|urgent.*response).*"
    score: 100
      message: "Obvious spam pattern detected"
    description: "Early rejection for blatantly obvious spam patterns"

  - name: "VIP Sender Priority"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*(government\\.gov|edu|mil|bank.*com|.*bank\\.com)$"
    score: -30
    description: "Priority processing for government, education, military, and banking domains"

  - name: "Resource Intensive Pattern Limit"
    enabled: true
    criteria:
      type: "SubjectPattern"
      pattern: ".{200,}"
    score: 15
    description: "Flag extremely long subjects that may cause processing delays"

  - name: "Bulk Email Quick Detection"
    enabled: true
    criteria:
      type: "HeaderPattern"
      header: "List-Unsubscribe"
      pattern: ".*"
    score: -10
    description: "Quick accept for emails with proper unsubscribe headers (likely legitimate bulk)"

  - name: "Empty Content Quick Reject"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SubjectPattern"
          pattern: "^\\s*$"
        - type: "EmptyContentEmail"
    score: 80
      message: "Empty email content"
    description: "Quick rejection for completely empty emails"

  - name: "Attachment Bomb Prevention"
    enabled: true
    criteria:
      type: "HeaderPattern"
      header: "Content-Length"
      pattern: "[5-9][0-9]{7,}|[1-9][0-9]{8,}"
    score: 40
      message: "Email size exceeds limits"
    description: "Prevent processing of extremely large emails (50MB+)"
