name: "Unsubscribe Analysis"
enabled: true
rules:
  - name: "Invalid Unsubscribe Headers"
    enabled: true
    criteria:
      type: "InvalidUnsubscribeHeaders"
    score: 30
    action:
      type: "TagAsSpam"
      header_name: "X-FOFF-Unsubscribe"
      header_value: "Invalid-Headers"
    description: "Detects RFC violation: List-Unsubscribe-Post without List-Unsubscribe header"

  - name: "Unsubscribe Link Uses IP Address"
    enabled: true
    criteria:
      type: "UnsubscribeLinkIPAddress"
      check_ipv4: true
      check_ipv6: true
      allow_private_ips: false
    score: 40
    action:
      type: "TagAsSpam"
      header_name: "X-FOFF-Unsubscribe"
      header_value: "IP-Address-Link"
    description: "Legitimate businesses use domains, not IP addresses for unsubscribe links"

  - name: "Mailto-Only Unsubscribe Links"
    enabled: false
    criteria:
      type: "UnsubscribeMailtoOnly"
      allow_mixed: false
    score: 25
    action:
      type: "TagAsSpam"
      header_name: "X-FOFF-Unsubscribe"
      header_value: "Mailto-Only"
    description: "Suspicious when ALL unsubscribe links are mailto: instead of HTTP"

  - name: "Suspicious Unsubscribe Link Patterns"
    enabled: true
    criteria:
      type: "UnsubscribeLinkPattern"
      pattern: "(?i).*(bit\\.ly|tinyurl|t\\.co|goo\\.gl|short\\.link|click\\.here).*"
    score: 30
    action:
      type: "TagAsSpam"
      header_name: "X-FOFF-Unsubscribe"
      header_value: "Suspicious-Pattern"
    description: "URL shorteners and suspicious patterns in unsubscribe links (excludes legitimate tracking tokens)"
