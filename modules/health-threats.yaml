name: "Health Threats"
enabled: true
# Pattern library references
pattern_libraries:
  - "patterns/common-patterns.yaml"
  - "patterns/spam-keywords.yaml"
rules:
  # Fake institutional health advice
  - name: "Fake Harvard health advice"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*\\[harvard\\].*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*harvard\\.edu.*"
    score: 100
    description: "Fake Harvard health advice from non-Harvard domains"

  # Medical misinformation and miracle cures (using pattern library)
  - name: "Medical miracle cure spam"
    criteria:
      type: "SubjectPattern"
      pattern_ref: "health_miracle_claims"  # Reference to common-patterns.yaml
    score: 70
    description: "Medical misinformation and miracle cure claims"

  # Vision and eye health scams (using pattern library)
  - name: "Vision health misinformation"
    criteria:
      type: "SubjectPattern"
      pattern_ref: "vision_health_scams"  # Reference to common-patterns.yaml
    score: 80
    description: "Vision and eye health misinformation"

  # Weight loss scams (using pattern library)
  - name: "Weight loss miracle claims"
    criteria:
      type: "SubjectPattern"
      pattern_ref: "weight_loss_scams"  # Reference to common-patterns.yaml
    score: 60
    description: "Weight loss and diet miracle claims"

  # Healthcare brand impersonation
  - name: "CVS Medicare phishing from free email"
    criteria:
      type: "BodyPattern"
      pattern: "(?i).*cvs.*medicare.*"
    score: 70
    description: "CVS Medicare phishing from free email providers"

  # Pharmaceutical spam (using pattern library)
  - name: "Pharmaceutical spam"
    criteria:
      type: "SubjectPattern"
      pattern_ref: "pharmaceutical_keywords"  # Reference to spam-keywords.yaml
    score: 80
    description: "Pharmaceutical and medication spam"

  # Remaining rules with direct patterns for now
  - name: "Tinnitus spam from suspicious domains"
    criteria:
      type: "And"
      criteria:
        - type: "HeaderPattern"
          header: "From"
          pattern: ".*@.*\\.(tk|ml|ga|cf|gq|top|click|download|stream|xyz|info|biz|online|site|website)$"
        - type: "SubjectPattern"
          pattern: "(?i).*(tinnitus|ringing.*ears|hearing.*loss|ear.*ringing).*"
    score: 90
    description: "Tinnitus and hearing health scams from suspicious domains"

  - name: "Foot and ankle health misinformation"
    criteria:
      type: "SubjectPattern"
      pattern: "(?i).*(foot.*pain|ankle.*pain|plantar.*fasciitis|foot.*stretch|heel.*pain|arch.*support|foot.*health).*"
    score: 50
    description: "Foot and ankle health misinformation and scams"

  - name: "Health rewards and insurance spam"
    enabled: true
    criteria:
      type: "Or"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(health.*reward|insurance.*reward|medicare.*reward|health.*benefit|insurance.*benefit|medicare.*benefit|health.*savings|insurance.*savings|medicare.*savings).*"
        - type: "BodyPattern"
          pattern: "(?i).*(health.*reward|insurance.*reward|medicare.*reward|health.*benefit|insurance.*benefit|medicare.*benefit|health.*savings|insurance.*savings|medicare.*savings).*"
    score: 50
    description: "Health insurance and reward spam"

  - name: "Breathing and lung health misinformation"
    criteria:
      type: "SubjectPattern"
      pattern: "(?i).*(breathing.*technique|lung.*health|respiratory.*health|oxygen.*levels|breathing.*exercise|lung.*capacity|asthma.*cure|copd.*treatment).*"
    score: 60
    description: "Breathing and lung health misinformation"

  - name: "Cardiovascular health misinformation"
    criteria:
      type: "SubjectPattern"
      pattern: "(?i).*(heart.*health|cardiovascular|circulation|blood.*flow|heart.*disease|stroke.*prevention|cardiac.*health|heart.*attack.*prevention).*"
    score: 60
    description: "Cardiovascular health misinformation and scams"

  - name: "Dental health misinformation"
    criteria:
      type: "SubjectPattern"
      pattern: "(?i).*(dental.*health|teeth.*whitening|gum.*disease|tooth.*decay|oral.*health|dental.*care|teeth.*cleaning|dental.*hygiene).*"
    score: 50
    description: "Dental health misinformation and scams"
