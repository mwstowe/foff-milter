name: "Phishing Scams"
enabled: true
rules:
  - name: "Mailer daemon spoofing"
    criteria:
      type: "SenderPattern"
      pattern: ".*MAILER-DAEMON.*"
    score: 60
    description: "MAILER-DAEMON spoofing detection"

  - name: "SEO and marketing services spam"
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(seo.*traffic|seo.*report|seo.*services|seo.*review|marketing.*services|website.*traffic|search.*ranking).*"
            - type: "BodyPattern"
              pattern: "(?i).*(seo.*gaps|seo.*services|traffic.*daily|search.*ranking|website.*optimization|marketing.*services.*seo|noticed.*gaps.*seo|send.*seo.*review|quick.*seo.*review).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*(google|secretlab)\\.(com|co)$"
    score: 55
    description: "Detects unsolicited SEO and marketing services spam"

  - name: "Portuguese document signature phishing"
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(lembrete.*assinatura|documento.*pendente|assinatura.*pendente|revisão.*eletrônica).*"
            - type: "BodyPattern"
              pattern: "(?i).*(documento.*disponível|acessar.*documento|revisão.*eletrônica|validade.*registro|clicksign|assinatura.*digital).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*(clicksign|docusign|adobe|microsoft|google).*"
    score: 80
    description: "Portuguese document signature phishing targeting Brazilian users"

  - name: "Fake autopay threat scam"
    criteria:
      type: "SubjectPattern"
      pattern: ".*(autopaid|auto.paid|auto-paid).*"
    score: 80
    description: "Detects fake autopay threat scams"

  - name: "Generic business development spam"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SubjectPattern"
          pattern: "(?i).*(business.*development|business.*opportunity|investment.*opportunity).*"
        - type: "Or"
          criteria:
            - type: "HeaderPattern"
              header: "Authentication-Results"
              pattern: ".*dkim=fail.*"
            - type: "SenderPattern"
              pattern: ".*@.*\\.(org|info|biz|tk|ml|ga|cf)$"
    score: 60
    description: "Detects generic business development spam with authentication failures or suspicious domains"

  - name: "Google Calendar spoofing"
    criteria:
      type: "HeaderPattern"
      header: "Sender"
      pattern: "(?i).*calendar-notification@google\\.com.*"
    score: 75
    description: "Detects spoofed Google Calendar notifications"

  - name: "Fake invoice and order receipt scam"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(order.*id.*receipt.*status.*approved|receipt.*status.*approved|invoice.*approved|payment.*confirmation.*\\$.*dispute|charge.*confirmation.*dispute).*"
            - type: "BodyPattern"
              pattern: "(?i).*(dispute.*this.*order|contact.*us.*immediately.*dispute|did.*not.*place.*this.*order|charge.*ending.*in.*\\d{4}.*dispute|payment.*method.*credit.*card.*ending.*in.*\\d{4}).*"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "SenderPattern"
                pattern: ".*@(lovepopcards\\.com|shopify\\.com|.*\\.shopify\\.com|amazon\\.com|.*\\.amazon\\.com|paypal\\.com|.*\\.paypal\\.com|stripe\\.com|.*\\.stripe\\.com|square\\.com|.*\\.square\\.com)$"
              - type: "HeaderPattern"
                header: "from"
                pattern: ".*@(lovepopcards\\.com|shopify\\.com|.*\\.shopify\\.com|amazon\\.com|.*\\.amazon\\.com|paypal\\.com|.*\\.paypal\\.com|stripe\\.com|.*\\.stripe\\.com|square\\.com|.*\\.square\\.com).*"
    score: 65
    description: "Fake invoice, order receipt, and payment confirmation scams"

  - name: "Urgent payment threat"
    criteria:
      type: "SubjectPattern"
      pattern: ".*(will be.*paid|payment.*hours|charged.*hours).*"
    score: 60
    description: "Detects urgent payment threat language"

  - name: "Fake payment confirmation and transaction scams"
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(thank.*you.*payment|payment.*transaction|transaction.*complete|payment.*received|confirmation.*payment).*"
            - type: "BodyPattern"
              pattern: "(?i).*(thank.*you.*payment|payment.*transaction|transaction.*complete|payment.*received|confirmation.*payment).*"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "SenderPattern"
                pattern: ".*@.*(paypal|stripe|square|amazon|ebay|apple|google|microsoft)\\.(com|net|org)$"
              - type: "SenderPattern"
                pattern: ".*@.*(bank|financial|credit|visa|mastercard|amex)\\.(com|net|org)$"
              - type: "SenderPattern"
                pattern: ".*@.*(topgolf|entertainment|gaming|casino|sports|recreation)\\.(com|net|org)$"
              - type: "SenderPattern"
                pattern: ".*@.*williams-sonoma\\.(com|net|org)$"
              - type: "SenderPattern"
                pattern: ".*Williams Sonoma.*"
              - type: "BodyPattern"
                pattern: "(?i).*(no.*purchase.*payment.*necessary|no.*purchase.*or.*payment.*of.*any.*kind|sweepstakes.*rules|contest.*rules|official.*rules).*"
              - type: "SubjectPattern"
                pattern: "(?i).*(bonus.*play|promotion|contest|sweepstakes|giveaway).*"
    score: 70
    description: "Detects fake payment confirmation and transaction scams"

  - name: "Advance fee fraud and business proposal scams"
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(private|confidential|urgent|business.*proposal|mutual.*benefit|privileged.*information).*"
            - type: "BodyPattern"
              pattern: "(?i).*(business.*proposal|mutually.*beneficial|privileged.*information|confidential.*matter|urgent.*response|await.*your.*response|beneficial.*business).*"
        - type: "Not"
          criteria:
            type: "Or"
            criteria:
              - type: "SenderPattern"
                pattern: ".*@.*(bank|government|official|legal|law|attorney|solicitor)\\.(com|gov|org)$"
              - type: "SenderPattern"
                pattern: ".*@.*(empower|fidelity|schwab|vanguard|financial|advisor|investment)\\.(com|net|org)$"
    score: 75
    description: "Detects advance fee fraud and suspicious business proposal scams"

  - name: "Fake product confirmation and tool set scams"
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(all-confirmed.*tool|confirmed.*stanley|tool.*set.*confirmed|order.*transaction.*processed|transaction.*processed.*confirmed).*"
            - type: "BodyPattern"
              pattern: "(?i).*(all-confirmed.*tool|confirmed.*stanley|tool.*set.*confirmed|order.*transaction.*processed|transaction.*processed.*confirmed|stanley.*tool.*set).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@(stanley\\.com|.*\\.stanley\\.com|stanleytools\\.com|.*\\.stanleytools\\.com|amazon\\.com|.*\\.amazon\\.com|shopify\\.com|.*\\.shopify\\.com).*"
    score: 75
    description: "Detects fake product confirmations and tool set scams"
