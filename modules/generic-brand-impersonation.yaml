name: "Generic Brand Impersonation"
enabled: true
rules:
  # Generic brand impersonation - any known brand from suspicious domain
  - name: "Known brand from suspicious domain"
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: "(?i).*(amazon|apple|microsoft|google|facebook|paypal|ebay|walmart|target|costco|bestbuy|homedepot|lowes|tmobile|t-mobile|verizon|att|sprint|netflix|disney|samsung|sony|nike|adidas|mcdonalds|starbucks|fedex|ups|usps|dhl|visa|mastercard|chase|bankofamerica|wells.*fargo|citibank|american.*express|aaa|twilio|sendgrid).*"
        - type: "SenderPattern"
          pattern: ".*@.*\\.(tk|ml|ga|cf|gq|top|click|download|stream|xyz|pw|cc|space|shop|online|site|website|store|biz|info|forum|club|party|date|racing|review|science|work|faith|loan|win)$"
    score: 120
    description: "Major brand names from high-risk or suspicious TLD domains"

  # Brand + urgent/deal keywords from suspicious domains
  - name: "Brand with urgency from suspicious domain"
    criteria:
      type: "And"
      criteria:
        - type: "Or"
          criteria:
            - type: "SenderPattern"
              pattern: "(?i).*(amazon|apple|microsoft|google|paypal|walmart|target|tmobile|verizon|netflix|disney|fedex|ups|visa|chase).*"
            - type: "SubjectPattern"
              pattern: "(?i).*(amazon|apple|microsoft|google|paypal|walmart|target|tmobile|verizon|netflix|disney|fedex|ups|visa|chase).*"
        - type: "Or"
          criteria:
            - type: "SubjectPattern"
              pattern: "(?i).*(urgent|immediate|expires|limited.*time|act.*now|final.*notice|suspended|verify|update|confirm|security.*alert|unauthorized).*"
            - type: "SubjectPattern"
              pattern: "(?i).*(deal|offer|discount|save|free|gift|reward|winner|prize|congratulations).*"
        - type: "SenderPattern"
          pattern: ".*@.*\\.(tk|ml|ga|cf|gq|top|click|download|stream|xyz|pw|cc|space|shop|online|site|website|store|biz|info|forum)$"
    score: 140
    description: "Brand impersonation with urgency/deals from suspicious domains"

  # Generic suspicious brand-like patterns
  - name: "Suspicious brand-like patterns"
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: "(?i).*[a-z]+(deal|offer|gift|reward|tech|mobile|store|shop|service|support|account|security|update|verify|confirm).*@.*"
        - type: "SenderPattern"
          pattern: ".*@.*\\.(tk|ml|ga|cf|gq|top|click|download|stream|xyz|pw|cc|space|shop|online|site|website|store|biz|info|forum)$"
    score: 80
    description: "Generic brand-like patterns from suspicious domains"

  # Brand impersonation from unrelated .com domains
  - name: "Brand impersonation from unrelated domains"
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: "(?i).*(amazon|apple|microsoft|google|paypal|walmart|target|tmobile|verizon|netflix|disney|fedex|ups|visa|chase|aaa).*"
        - type: "Not"
          criteria:
            type: "SenderPattern"
            pattern: ".*@.*(amazon|apple|microsoft|google|paypal|walmart|target|tmobile|verizon|netflix|disney|fedex|ups|visa|chase|aaa)\\.(com|net|org)$"
    score: 100
    description: "Major brand names from unrelated domains (even .com)"

  # Legitimate domain override (negative scoring)
  - name: "Legitimate brand domains override"
    criteria:
      type: "SenderPattern"
      pattern: ".*@(amazon|apple|microsoft|google|facebook|paypal|ebay|walmart|target|costco|bestbuy|homedepot|lowes|tmobile|t-mobile|verizon|att|sprint|netflix|disney|samsung|sony|nike|adidas|mcdonalds|starbucks|fedex|ups|usps|dhl|visa|mastercard|chase|bankofamerica|wellsfargo|citi|americanexpress|twilio|sendgrid)\\.(com|net|org)$"
    score: -150
    description: "Override for legitimate brand domains (excludes tenant domains)"
