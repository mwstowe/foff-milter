name: "Advanced Security"
enabled: true
rules:
  - name: "Attachment-Only Emails"
    enabled: true
    criteria:
      type: "AttachmentOnlyEmail"
    score: 30
    action:
      type: "TagAsSpam"
      header_name: "X-FOFF-Security"
      header_value: "Attachment-Only"
    description: "Emails with only attachments and no meaningful content"

  - name: "Empty Content Emails"
    enabled: true
    criteria:
      type: "EmptyContentEmail"
    score: 25
    action:
      type: "TagAsSpam"
      header_name: "X-FOFF-Security"
      header_value: "Empty-Content"
    description: "Emails with no subject or body content"

  - name: "Image-Only Emails"
    enabled: true
    criteria:
      type: "ImageOnlyEmail"
    score: 35
    action:
      type: "TagAsSpam"
      header_name: "X-FOFF-Security"
      header_value: "Image-Only"
    description: "Emails containing only images to bypass text filters"

  - name: "HTML Entity Obfuscation"
    enabled: true
    criteria:
      type: "BodyPattern"
      pattern: "(?i).*&#[0-9]{2,3};.*&#[0-9]{2,3};.*&#[0-9]{2,3};.*"
    score: 30
    action:
      type: "TagAsSpam"
      header_name: "X-FOFF-HTML-Obfuscation"
      header_value: "HTML entity obfuscation detected"
    description: "Detects HTML entity encoding used to obfuscate malicious domains"

  - name: "Suspicious Encoding Patterns"
    enabled: true
    criteria:
      type: "SubjectPattern"
      pattern: "(?i).*=\\?[a-z0-9-]+\\?[bq]\\?[a-z0-9+/=]{50,}\\?=.*"
    score: 20
    action:
      type: "TagAsSpam"
      header_name: "X-FOFF-Security"
      header_value: "Suspicious-Encoding"
    description: "Suspicious base64 or quoted-printable encoding patterns"
