name: "Analytics"
enabled: true
rules:
  - name: "High Volume Sender Detection"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@.*(bulk|mass|newsletter|marketing|promo|campaign|blast|mailer).*"
    score: 15
    action:
      type: "TagAsSpam"
      header_name: "X-FOFF-Analytics"
      header_value: "High-Volume-Sender"
    description: "Detects high-volume email senders with suspicious patterns"

  - name: "Suspicious Timing Patterns"
    enabled: true
    criteria:
      type: "HeaderPattern"
      header: "Date"
      pattern: ".*(0[0-4]:[0-5][0-9]:[0-5][0-9]|2[3-4]:[0-5][0-9]:[0-5][0-9]).*"
    score: 10
    action:
      type: "TagAsSpam"
      header_name: "X-FOFF-Analytics"
      header_value: "Suspicious-Timing"
    description: "Emails sent during suspicious hours (midnight to 5am, 11pm-midnight)"

  - name: "Sequential Email Pattern"
    enabled: true
    criteria:
      type: "RecipientPattern"
      pattern: ".*[0-9]{3,}@.*"
    score: 20
    action:
      type: "TagAsSpam"
      header_name: "X-FOFF-Analytics"
      header_value: "Sequential-Pattern"
    description: "Recipients with sequential numbers indicating enumeration attacks"

  - name: "Burst Pattern Indicators"
    enabled: true
    criteria:
      type: "HeaderPattern"
      header: "Message-ID"
      pattern: ".*[0-9]{10,}.*"
    score: 5
    action:
      type: "TagAsSpam"
      header_name: "X-FOFF-Analytics"
      header_value: "Burst-Pattern"
    description: "Message IDs with long numeric sequences indicating automated sending"

  - name: "Generic Sender Names"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: ".*(no-reply|noreply|donotreply|admin|support|info|contact|service|team|notification|alert)@.*"
        - type: "Not"
          criteria:
            type: "HeaderPattern"
            header: "From"
            pattern: ".*@(asus\\.com|.*\\.asus\\.com|microsoft\\.com|.*\\.microsoft\\.com|google\\.com|.*\\.google\\.com|amazon\\.com|.*\\.amazon\\.com|apple\\.com|.*\\.apple\\.com|shopify\\.com|.*\\.shopify\\.com|lovepopcards\\.com).*"
    score: 5
    action:
      type: "TagAsSpam"
      header_name: "X-FOFF-Analytics"
      header_value: "Generic-Sender"
    description: "Generic sender addresses often used in bulk spam campaigns"

  - name: "Sender Name Mismatch"
    enabled: true
    criteria:
      type: "And"
      criteria:
        - type: "SenderPattern"
          pattern: "(?i).*@(gmail|yahoo|hotmail|outlook|aol)\\.(com|co\\.uk)$"
        - type: "HeaderPattern"
          header: "from"
          pattern: "(?i)^[A-Z]{3,15}\\s*<.*@.*>$"
    score: 20
    action:
      type: "TagAsSpam"
      header_name: "X-FOFF-Sender-Mismatch"
      header_value: "Generic sender name from free email provider"
    description: "Detects generic all-caps sender names from free email providers"

  - name: "Suspicious Domain Age Indicators"
    enabled: true
    criteria:
      type: "SenderPattern"
      pattern: ".*@[a-z0-9]{6,12}\\.(tk|ml|ga|cf|gq|top|click|download|stream|xyz|info|biz)$"
    score: 25
    action:
      type: "TagAsSpam"
      header_name: "X-FOFF-Analytics"
      header_value: "New-Domain-Pattern"
    description: "Random domain names on suspicious TLDs indicating newly registered domains"
